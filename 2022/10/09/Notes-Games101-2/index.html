<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Games101课程笔记（二） | 楸涵の小窝</title><meta name="author" content="楸涵"><meta name="copyright" content="楸涵"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Games101课程的学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="Games101课程笔记（二）">
<meta property="og:url" content="https://himoqiuhan.github.io/2022/10/09/Notes-Games101-2/index.html">
<meta property="og:site_name" content="楸涵の小窝">
<meta property="og:description" content="Games101课程的学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://himoqiuhan.github.io/images/avatar.png">
<meta property="article:published_time" content="2022-10-08T16:00:01.000Z">
<meta property="article:modified_time" content="2024-07-27T15:13:59.651Z">
<meta property="article:author" content="楸涵">
<meta property="article:tag" content="图形学">
<meta property="article:tag" content="GAMES">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://himoqiuhan.github.io/images/avatar.png"><link rel="shortcut icon" href="/images/favicon.png"><link rel="canonical" href="https://himoqiuhan.github.io/2022/10/09/Notes-Games101-2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Games101课程笔记（二）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-27 23:13:59'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="css/resources.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="css/progress_bar.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="楸涵の小窝" type="application/atom+xml">
</head><body><script>window.paceOptions = {
  restartOnPushState: false
}

document.addEventListener('pjax:send', () => {
  Pace.restart()
})
</script><link rel="stylesheet" href="/css/progress_bar.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">53</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-house"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fab fa-facebook-messenger"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-meteor"></i><span> AboutMe</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/105115167_p0_master1200.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="楸涵の小窝"><span class="site-name">楸涵の小窝</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-house"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fab fa-facebook-messenger"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-meteor"></i><span> AboutMe</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Games101课程笔记（二）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-10-08T16:00:01.000Z" title="发表于 2022-10-09 00:00:01">2022-10-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-27T15:13:59.651Z" title="更新于 2024-07-27 23:13:59">2024-07-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Notes/">Notes</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>40分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Games101课程笔记（二）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="光线追踪-Ray-Tracing">光线追踪 Ray Tracing</h2>
<h3 id="Why-Ray-Tracing">Why Ray Tracing</h3>
<ul>
<li>
<p><strong>光栅化不易于把一些全局的效果处理好</strong></p>
<ul>
<li>
<p>阴影（软阴影）</p>
</li>
<li>
<p>尤其是光线的多次反射（Glossy reflection, indirect illumination）</p>
</li>
</ul>
</li>
<li>
<p>光栅化很快，但是质量相对较低（一种快速的近似）</p>
</li>
<li>
<p><strong>光线追踪很准确，但是很慢</strong></p>
<ul>
<li>Rasteriaztion：real-time，Ray Tracing：offline</li>
<li>生成1帧图大概需要渲染10k CPU hours</li>
</ul>
</li>
</ul>
<h3 id="Basic-Ray-Tracing-Algorithm">Basic Ray-Tracing Algorithm</h3>
<h4 id="Light-Rays">Light Rays</h4>
<p>关于光线的三个idea：</p>
<ul>
<li>光沿直线传播（虽然实际上是错的）</li>
<li>即使光线之间彼此相交，光线也不会与彼此发生碰撞</li>
<li>光线从光源沿着一定的路径射向眼睛，且光路可逆</li>
</ul>
<p>实际上光线追踪是<strong>从相机出发向世界中投射光线</strong></p>
<h4 id="Ray-Casting">Ray Casting</h4>
<p><strong>光线投射</strong></p>
<ol>
<li>
<p>从相机处此处认为相机是一个点)，对成像平面上的每一个像素向场景中投射光线，记录最近的交点（类似深度）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221029140055230.png" alt="image-20221029140055230" style="zoom:50%;" />
</li>
<li>
<p>（考虑记录的交点会不会被照亮）连接交点和光源（shadow ray），如果shadow ray上没有其他物体，那么说明这个交点被光源照亮，再执行shading计算得出像素的颜色</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221029140510644.png" alt="image-20221029140510644" style="zoom:50%;" />
</li>
</ol>
<p><strong>局限：还是只考虑了一次光线的反射</strong></p>
<h4 id="Recursive-Whitted-Style-Ray-Tracing">Recursive(Whitted-Style) Ray Tracing</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221029140801196.png" alt="image-20221029140801196" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221029141444034.png" alt="image-20221029141444034" style="zoom:50%;" />
<h3 id="Ray-Surface-Intersection">Ray-Surface Intersection</h3>
<h4 id="Ray-Equation">Ray Equation</h4>
<ul>
<li><strong>用==光源==和==一条方向向量==定义光线</strong></li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031134715406.png" alt="image-20221031134715406" style="zoom:50%;" />
<ul>
<li><strong>Ray Equation：</strong>（ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>：时间,非负 ）</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo>+</mo><mi>t</mi><mi>d</mi><mtext>   </mtext><mn>0</mn><mo>&lt;</mo><mi>t</mi><mo>&lt;</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">r(t)=0 + td \ \ \ 0&lt;t&lt;\infty
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6542em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">∞</span></span></span></span></span></p>
<ul>
<li>Ray Intersection with Sphere：</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031134829060.png" alt="image-20221031134829060" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031135046371.png" alt="image-20221031135046371" style="zoom:50%;" />
<ul>
<li>推广到光线与Implicit Surface隐式表面的求交：</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031135523563.png" alt="image-20221031135523563" style="zoom:50%;" />
<h4 id="Plane-Equation">Plane Equation</h4>
<ul>
<li><strong>用==一个点==和==一条法线向量==定义一个平面</strong></li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031142041202.png" alt="image-20221031142041202" style="zoom:50%;" />
<ul>
<li><strong>Plane Equation：</strong></li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>:</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><mi>N</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p:(p-p&#x27;) \cdot N = 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>+</mo><mi>c</mi><mi>z</mi><mo>+</mo><mi>d</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">ax + by + cz + d = 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">cz</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
<ul>
<li>
<p>光线和三角形面求交：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031141814818.png" alt="image-20221031141814818" style="zoom:50%;" />
<p>转换为两步：</p>
<ul>
<li>
<p>光线与平面求交</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031142541219.png" alt="image-20221031142541219" style="zoom:50%;" />
</li>
<li>
<p>然后再通过cross判断交点是否在三角形内部即可</p>
</li>
</ul>
</li>
</ul>
<h4 id="Moller-Trumbore-Algorithm">Moller Trumbore Algorithm</h4>
<p>简化三角形和光线求交的算法</p>
<p>原理：一个点在三角形内，那么就可以写为重心坐标的形式，那么一个交点就应该同时<strong>满足光线方程</strong>和<strong>存在三角形重心坐标</strong>两个条件（通过<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>b</mi><mn>1</mn></msub><mo>−</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b_1,b_2,(1-b_1-b_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>三者之和等于一和及三者非负即可判断点在三角形内）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031143750573.png" alt="image-20221031143750573" style="zoom:50%;" />
<h3 id="Accelerating-Ray-Surface-Intersection">Accelerating Ray-Surface Intersection</h3>
<h4 id="Bounding-Volumes（BVol）">Bounding Volumes（BVol）</h4>
<ul>
<li>一个可以完全包围物体的体积</li>
<li>如果光线不hit包围盒，他就不会hit物体</li>
<li>所以可以先检测BVol是否被hit，如果hit了再检测物体</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031144453059.png" alt="image-20221031144453059" style="zoom:50%;" />
<h4 id="Ray-Intersection-with-Box">Ray-Intersection with Box</h4>
<p>理解Box：Box是三组相对的面形成的交集（Box is the intersection of 3 pairs of slabs）</p>
<p>通常用<strong>Axis-Aligned Bounding Box(AABB)</strong>（轴对齐包围盒）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031144835452.png" alt="image-20221031144835452" style="zoom:50%;" />
<h4 id="Ray-Intersection-with-Axis-Aligned-Box">Ray Intersection with Axis-Aligned Box</h4>
<p>原理：计算光线和平面相交的时间，并判断得到光线在BVol内部的时间（起始时间为最后一个轴向的进入时间，结束时间为最早一个轴向的离开时间）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031145701232.png" alt="image-20221031145701232" style="zoom:50%;" />
<p>三维空间中：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031145808578.png" alt="image-20221031145808578" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031150424561.png" alt="image-20221031150424561" style="zoom:50%;" />
<p>为什么用Axis-Aligned的绑定盒：极大地简化加速求交</p>
<p>用随意的包围盒，进行求交时要做三个轴向上的减法，再乘法线，就会有3次减法，六次乘法和一次除法</p>
<p>而用轴向包围盒，只需要考虑一个轴向的距离，除上光线在该轴的分量即可</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031150546448.png" alt="image-20221031150546448" style="zoom:50%;" />
<p>AABB totally : 3 subtraction, 3 division, get min and max</p>
<h4 id="Using-AABBs-to-accelerate-ray-tracing">Using AABBs to accelerate ray tracing</h4>
<h5 id="Uniform-Spatial-Partition-Grids">Uniform Spatial Partition(Grids)</h5>
<h6 id="Preprocess-—-Build-Acceleration-Grid">Preprocess — Build Acceleration Grid</h6>
<p>找到场景的包围盒，在包围盒内划分网格，判定哪些网格里与物体相交并<strong>标记</strong>与物体相交的网格（只考虑表面不考虑内部）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031152717717.png" alt="image-20221031152717717" style="zoom:50%;" />
<h6 id="Ray-Scene-Intersection">Ray-Scene Intersection</h6>
<p>投射光线，顺着光线方向与一个一个的盒子求交，对于预处理过程中没有被标记的盒子不需要做与实际物体求交的操作；当光线遇到在预处理过程中被标记的盒子时，意味着这个盒子里会有物体，光线有可能会与物体有交点，所以需要在这个格子内与物体求交进行判断；当找到光线与物体的第一个交点后光线就可以停下来了</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031153948853.png" alt="image-20221031153948853" style="zoom:50%;" />
<p>”沿着光线方向“的实现方法：（一种没有在用但是很好理解的方法）光栅化一条直线的方法：知道这个盒子现在在和光线求交，那么下一次和光线进行求交的一定是他周围的盒子</p>
<h6 id="Grid-Resolution">Grid Resolution</h6>
<p>包围盒内的网格太密集太疏松都不好</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031154933884.png" alt="image-20221031154933884" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031155023804.png" alt="image-20221031155023804" style="zoom:50%;" />
<p>效果不错的格子数量：（这也并非游戏中实际使用的方法，因为它还是要走过他所相交的所有格子，只用知道Grid数量不能太多或太少，有一个平衡就好）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031155110244.png" alt="image-20221031155110244" style="zoom:50%;" />
<h6 id="When-Uniform-Grids-Fail">When Uniform Grids Fail</h6>
<p>适合应用于场景中有很多物体的情况</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031155418553.png" alt="image-20221031155418553" style="zoom:50%;" />
<p>但是不适合用于场景很空的情况——”Teapot in a stadium“ problem</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031155604320.png" alt="image-20221031155604320" style="zoom:50%;" />
<h5 id="Spatial-Partitions">Spatial Partitions</h5>
<h6 id="Spatial-Partitioning-Examples">Spatial Partitioning Examples</h6>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031155754217.png" alt="image-20221031155754217" style="zoom:50%;" />
<ul>
<li>Oct-Tree：八叉树（平面情况是四叉树——和维度绑定，在高维度不好计算）</li>
<li>KD-Tree：和八叉树几乎完全相同，区别在每次找到一个物体就会在轴向上砍一刀，形成类似二叉树的结构；KD-Tree是层之间循环轴向切割，即这一层沿着x方向，下一层就沿着y方向，再下一层沿着z方向，以xyz顺序循环</li>
<li>BSP-Tree：每一次选一个方向将节点砍开，与KD-Tree区别在于不是横平竖直地砍，且在高维度会不好计算</li>
</ul>
<h6 id="KD-Tree-Pre-Processing">KD-Tree Pre-Processing</h6>
<p>在进行光追前先做好加速结构，再去考虑与光线求交</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031160655382.png" alt="image-20221031160655382" style="zoom:50%;" />
<p>注：蓝色绿色部分都会砍开，只是没有画出来</p>
<ul>
<li>中间节点只需要记录它会被如何划分</li>
<li>叶子节点（决定不再划分地节点）才需要再去存储和格子相交的几何形体的信息</li>
</ul>
<h6 id="Data-Structure-for-KD-Trees">Data Structure for KD-Trees</h6>
<p>中间节点存储：</p>
<ul>
<li>该节点向下分裂的轴向</li>
<li>平面沿着轴向的分裂位置</li>
<li>指向子节点的指针</li>
<li><strong>实际物体不会储存在中间节点内</strong></li>
</ul>
<p>叶子节点：</p>
<ul>
<li>储存实际物体的链表</li>
</ul>
<h6 id="Traversing-a-KD-Tree">Traversing a KD-Tree</h6>
<p>光线照射进入BVol</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031164219472.png" alt="image-20221031164219472" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031164252835.png" alt="image-20221031164252835" style="zoom:50%;" />
<p>发现A内有物体，就需要和A的两个子节点都进行求交（A有分支，就对A和他的子分支求交，以此递归，直到找到叶子节点）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031164335169.png" alt="image-20221031164335169" style="zoom: 25%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031164346824.png" alt="image-20221031164346824" style="zoom:25%;" />
<p>以此向下进行</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031164720396.png" alt="image-20221031164720396" style="zoom:50%;" />
<p>即：光线如果和该节点有交点，那么光线会向下对该节点的两个子节点求交；如果光线和该节点没有交点就不会继续对该节点的子节点求交；以此向下进行，直到找到叶子节点</p>
<h6 id="Problem">Problem</h6>
<ul>
<li>KD-Tree的建立不简单，需要考虑三角形与盒子的求交（举例：三角形三个顶点不在盒子内，但是这个盒子内有三角形的一部分的情况，不容易处理三角形与盒子的求交）</li>
<li>物体可能存在于多个盒子内</li>
</ul>
<h5 id="Object-Partition-Bounding-Volume-Hierarchy-BVH">Object Partition &amp; Bounding Volume Hierarchy(BVH)</h5>
<p>以物体为根基，把物体”分堆“并重新计算他们的包围盒——解决了物体可能存在于多个盒子内的问题</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031165738846.png" alt="image-20221031165738846" style="zoom:25%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031165706006.png" alt="image-20221031165706006" style="zoom:25%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031165715402.png" alt="image-20221031165715402" style="zoom:25%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031165725003.png" alt="image-20221031165725003" style="zoom:25%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031165916240.png" alt="image-20221031165916240" style="zoom: 50%;" />
<p>实际上如何划分一个节点：</p>
<ul>
<li>选择一个维度去划分</li>
<li>Heuristic ##1：总是沿着最长的轴去划分，让最长的轴变短，让整个结构最后变得均匀</li>
<li>Heuristic ##2：取中间的物体进行划分(第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{n}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>个)，让这棵树接近平衡
<ul>
<li>无序的一列数快速找出中位数（不需要排序）：快速选择算法，只对快排划分出的某一边进行操作，可以使时间复杂度在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">O_{(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>以内</li>
</ul>
</li>
</ul>
<p>最终取值：</p>
<ul>
<li>Heuristic：节点内含有少量元素时终止</li>
</ul>
<h6 id="Data-Structure-for-BVHs">Data Structure for BVHs</h6>
<p>中间节点存储：</p>
<ul>
<li>包围盒</li>
<li>指向子节点的指针</li>
</ul>
<p>叶子节点存储：</p>
<ul>
<li>包围盒</li>
<li>存储实际对象的链表</li>
</ul>
<p>节点代表场景中原始物体的交集</p>
<ul>
<li>所有物体都在subtree中</li>
</ul>
<h6 id="BVH-Traveral">BVH Traveral</h6>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221031175944272.png" alt="image-20221031175944272" style="zoom:50%;" />
<h6 id="Spatial-vs-Object-Partitions">Spatial vs Object Partitions</h6>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102090457290.png" alt="image-20221102090457290" style="zoom:50%;" />
<h4 id="Basic-Radiometry">Basic Radiometry</h4>
<p>—— <strong>辐射度量学</strong></p>
<h6 id="why-radiomentry">why radiomentry</h6>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102092649223.png" alt="image-20221102092649223" style="zoom:50%;" />
<h6 id="Radiometry">Radiometry</h6>
<ul>
<li>
<p>Measurement system and units for illumination</p>
</li>
<li>
<p>精确测量光在空间中的属性，并且还是基于几何光学（光沿直线传播，不考虑波动性）</p>
<ul>
<li>New terms：Radiant flux，intensity，irradiance，radiance</li>
</ul>
</li>
<li>
<p>辐射度量学实际上是在物理上准确定义光照的方法</p>
</li>
</ul>
<h6 id="Radiant-Energy-and-Flux-Power">Radiant Energy and Flux(Power)</h6>
<p>######## Radiant Energy</p>
<p>Radiant energy是电磁辐射的能量，以焦耳为单位，用符号表示：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Q</mi><mo stretchy="false">[</mo><mi>J</mi><mo>=</mo><mi>J</mi><mi>o</mi><mi>u</mi><mi>l</mi><mi>e</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Q[J=Joule]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mclose">]</span></span></span></span></span></p>
<p>######## Radiant flux(power)</p>
<p>单位时间内发射、反射、转换或接收的能量</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mfrac><mrow><mi>d</mi><mi>Q</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mtext> </mtext><mo stretchy="false">[</mo><mi>W</mi><mo>=</mo><mi>W</mi><mi>a</mi><mi>t</mi><mi>t</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>l</mi><mi>m</mi><mo>=</mo><mi>l</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><msup><mo stretchy="false">]</mo><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\phi = \frac{dQ}{dt}\ [W = Watt][lm = lumen]^*
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace"> </span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Wa</span><span class="mord mathnormal">tt</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>(lumen是光学上的单位，理解为光的亮度)</p>
<p>Flus —— 单位时间通过感光位置的光子量</p>
<h6 id="Radiant-intensity">Radiant intensity</h6>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102094718694.png" alt="image-20221102094718694" style="zoom:50%;" />
<p>######## Definition</p>
<p>The radiant (luminous) intensity is the power <strong>per unit solid angle</strong> emitted by a point light source</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102095000345.png" alt="image-20221102095000345" style="zoom:50%;" />
<p>######## Solid angles and Solid angle</p>
<p><strong>Angle</strong>: ratio of subtended arc length on circle to radius</p>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mfrac><mi>l</mi><mi>r</mi></mfrac></mrow><annotation encoding="application/x-tex">\theta = \frac{l}{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
</li>
<li>
<p>Circle has 2<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> <strong>radians</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102100132926.png" alt="image-20221102100132926" style="zoom:50%;" />
</li>
</ul>
<p><strong>Solid angle</strong>: ratio of subtended area on sphere to radius squared</p>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>=</mo><mfrac><mi>A</mi><msup><mi>r</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\Omega = \frac{A}{r^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
</li>
<li>
<p>Spere has 4<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> <strong>steradians</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102100151541.png" alt="image-20221102100151541" style="zoom:50%;" />
</li>
<li>
<p>弧度在球面上的延申——球弧度，立体角描述空间上的角张开的大小</p>
</li>
</ul>
<p>######## Differential Solid Angles</p>
<p>微分立体角：理解为取一个方向在球面上打到的点，再将这个方向向量的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span>都增加一个极小的量，最后投影到球面上得到的一个小曲面对应的立体角</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102100229494.png" alt="image-20221102100229494" style="zoom:50%;" />
<p>对微分立体角在整个球面上积分可以得到整个球的表面积</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102100253612.png" alt="image-20221102100253612" style="zoom:50%;" />
<p>######## <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span> as a direction vector</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102100509856.png" alt="image-20221102100509856" style="zoom:50%;" />
<p>######## Isotropic Point Source</p>
<p>Radiant intensity(intensity)就是单位时间内光源向各个方向发射的光子能量强度</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221102100617487.png" alt="image-20221102100617487" style="zoom:50%;" />
<p>intensity是单位面积上的power，因此对intensity在面积上进行积分可以得到power</p>
<h6 id="Irradiance">Irradiance</h6>
<p>######## Definition</p>
<p>The irradiance is the <strong>power per unit area</strong> incident on a surfacec point</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103082924980.png" alt="image-20221103082924980" style="zoom:50%;" />
$$
E_{(x)} = \frac{d\phi (x)}{dA}
\cr
[\frac{W}{m^2}][\frac{lm}{m^2}=lux]
$$
这个**area**必须是与光线垂直的部分，如果不垂直的话要把光线投影到垂直方向
<ul>
<li>lambert计算漫反射时需要投影到垂直部分</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103082948987.png" alt="image-20221103082948987" style="zoom:50%;" />
<ul>
<li>
<p>四季的原因：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103083352319.png" alt="image-20221103083352319" style="zoom:50%;" />
</li>
</ul>
<p>######## light Falloff</p>
<p>Light falloff的正确解释：不是intensity的衰减，而是irradiance的衰减，传播到越往外面积越小，irradiance越小</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103083757218.png" alt="image-20221103083757218" style="zoom:50%;" />
<h6 id="Radiance">Radiance</h6>
<p>######## Definition</p>
<p>The radiance (luminance) is the power emitted, reflected, transmitted or received by a surfae, <strong>per unit solid angle</strong>,  <strong>per projected unit area</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103091228894.png" alt="image-20221103091228894" style="zoom:50%;" />
<p>对power的两次微分：单位立体角、单位投影面积</p>
<p>一个单位面积可能和光的朝向不垂直，在度量特定方向的光的朝向时需要进行投影，即需要确定某一个特定的面和某一个特定的方向，通过这样的方式去定义光线</p>
<p>######## Radiance comprehension</p>
<p>Recall</p>
<ul>
<li>Irradiance：power per projected unit area</li>
<li>Intensity：power per solid angel</li>
</ul>
<p>So</p>
<ul>
<li>Radiance：Irradiance per solid angle</li>
<li>Radiance：Intensity per projected unit area</li>
</ul>
<p>######## Incident Radiance</p>
<p>一个面接收到的能量：</p>
<p>入射Radiance是单位立体角上的到达入射表面的irradiance，即radiance和irradiance的区别在于是否有方向性</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103092219803.png" alt="image-20221103092219803" style="zoom:50%;" />
<p>######## Exiting Radiance</p>
<p>一个面发射出去的能量：</p>
<p>出射Radiance是在单位投影面积上的intensity，即radiance和intensity的区别在于是否投影到单位面积</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103092447422.png" alt="image-20221103092447422" style="zoom:50%;" />
<p>######## Irradiance vs. Radiance</p>
<p>Irradiance：一个很小的范围收到的<strong>所有</strong>的能量</p>
<p>Radiance：一个很小的范围收到的<strong>特定方向</strong>的能量</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103092653435.png" alt="image-20221103092653435" style="zoom:50%;" />
<h4 id="BRDF-and-Rendering-Equation">BRDF and Rendering Equation</h4>
<p><strong>Bidirectional Reflection Distribution Function 双向反射分布函数</strong></p>
<h6 id="BRDF">BRDF</h6>
<p><strong>反射的解释：</strong></p>
<p>Radiance从<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\omega_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>方向打到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">dA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span></span></span></span>成为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">dA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span></span></span></span>接收到的power<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>，然后power<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>会成为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">dA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span></span></span></span>向任意的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>方向的Radiance</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221103175101463.png" alt="image-20221103175101463" style="zoom:50%;" />
<p>Differential irradiance incoming：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>E</mi><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>c</mi><mi>o</mi><mi>s</mi><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>ω</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">dE(\omega_i) = L(\omega_i)cos\theta_id\omega_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">cos</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>Differential radiance exiting (due to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>E</mi><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dE(\omega_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>)：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>L</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>r</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dL_r(\omega_r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p><strong>BRDF的解释：</strong></p>
<p>定义一个函数，描述微小面积<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">dA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span></span></span></span>，从某一个微小立体角<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>ω</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d\omega_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>接收到的irradiance会如何被分配到各个不同的立体角上去，即一个比例，任何一个出射方向的radiance去除以这一个小块接收到的irradiance</p>
<p><strong>BRDF的定义：</strong></p>
<p>The Bidirectional Reflection Distribution Function respresents how much light is reflected into each outgoing direction <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">\omega_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> from each incoming direction</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104083838585.png" alt="image-20221104083838585" style="zoom: 67%;" />
$$
f_r(\omega_i\rightarrow\omega_r)=\frac{dL_r(\omega_r)}{dE_i(\omega_i)}=\frac{dL_r(\omega_r)}{L_i(\omega_i)cos{\theta_i}d\omega_i}[\frac{1}{sr}]
$$
BRDF理解：从一个方向进来，打到物体后，物体向各个方向反射的能量分布情况。比如说物体是镜面的，镜面反射方向分分布了所有能量，其他方向没有能量；如果是漫反射，能量会均等的向各个方向分布。BRDF描述了光线和物体如何作用，他决定了物体不同的材质会怎么回事
<h6 id="Reflection-Equation">Reflection Equation</h6>
<p><strong>考虑入射的全部方向：反射方程</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104084617363.png" alt="image-20221104084617363" style="zoom:67%;" />
$$
L_r(p,\omega_r) = \int_{H^2}f_r(p,\omega_r \rightarrow\omega_r)L_i(p,\omega_i)L_i(p,\omega_i)cos{\theta_i}d\omega_i
$$
将所有入射方向的贡献积分起来形成最终的出射的radiance
<p><strong>Challenge： Recursive Equation</strong></p>
<p>光线在场景中不可能只弹射一次，任何出射的radiance都可能成为别的面的入射radiance，会存在一个递归的形式</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104085337313.png" alt="image-20221104085337313" style="zoom:50%;" />
<h6 id="Rendering-Equation"><strong>Rendering Equation</strong></h6>
<p>考虑自发光后：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mi>o</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>L</mi><mi>e</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mtext> </mtext><mo>+</mo><mtext> </mtext><msub><mo>∫</mo><mrow><mi mathvariant="normal">Ω</mi><mo>+</mo></mrow></msub><msub><mi>L</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">⋅</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>d</mi><msub><mi>ω</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_o(p,\omega_o) = L_e(p,\omega_o)\ +\ \int_{\Omega+} L_i(p,\omega_i)f_r(p,\omega_i,\omega_o)(n·\omega_i)d\omega_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3303em;vertical-align:-0.9703em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.4336em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Ω</span><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>假定所有方向都指向外</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>+</mo></mrow><annotation encoding="application/x-tex">\Omega+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">Ω</span><span class="mord">+</span></span></span></span>同<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">H^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>都表示半球（下半球的光不会造成影响，所以考虑的只是半个球体，而非一个球体）</li>
</ul>
<h6 id="Summary">Summary</h6>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104090700392.png" alt="image-20221104090700392" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104090725287.png" alt="image-20221104090725287" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104090859301.png" alt="image-20221104090859301" style="zoom:50%;" />
<p>将渲染方程简化为一个积分方程</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104091148088.png" alt="image-20221104091148088" style="zoom:50%;" />
<p>可以把渲染方程进一步简化为一个线性矩阵方程</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104091157031.png" alt="image-20221104091157031" style="zoom:50%;" />
<p>最终就是要<strong>把L解出来</strong></p>
<p>写成这么一种算子的形式，因为这个算子同样有类似泰勒展开的性质，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>−</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">I-K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>虽然是矩阵，但也可以写作这样的形式</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104092026337.png" alt="image-20221104092026337" style="zoom:50%;" />
<p>最终看到的能量分解为：直接看到的光源能量(自发光)+光线弹射一次看到的能量(直接光照)+光线弹射两次看到的能量(间接光照)+…(间接光照)…</p>
<p><strong>所有光线弹射的间接光照得到的集合是全局光照</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104091413994.png" alt="image-20221104091413994" style="zoom:50%;" />
<p>从光栅化的角度来看渲染方程的分解，着色做的就是分解项的前两项，即光栅化能告诉我们的内容就只有自发光和直接光照部分，后面的部分就会比较麻烦</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104092649362.png" alt="image-20221104092649362" style="zoom:50%;" />
<p>光照弹射次数的效果对比：</p>
<p><img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221104093301048.png" alt="image-20221104093301048"></p>
<h2 id="路径追踪-Path-Tracing">路径追踪 Path Tracing</h2>
<h3 id="Monte-Carlo-Integration">Monte Carlo Integration</h3>
<h4 id="What-How">What&amp;How</h4>
<p>What：解一个定积分：不写出不定积分积分后的解析式，而是直接获得定积分</p>
<p>How：在积分域内不断去采样，把整个积分区域的函数当作是一个矩形（y相等），采样采到的x对应的y就作为整个函数的y，这样多次采样后再求平均</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105083750946.png" alt="image-20221105083750946" style="zoom:50%;" />
<h4 id="Definition">Definition</h4>
<p>通过给定的函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>定义Monte Carlo Integration</p>
<ul>
<li>
<p>Definite integral</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\int_{a}^{b}f(x)dx
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.511em;vertical-align:-0.9119em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.599em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span></span></p>
</li>
<li>
<p>Random variable</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105084618612.png" alt="image-20221105084618612" style="zoom:50%;" />
</li>
<li>
<p>Monte Carlo estimator</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>N</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">F_N = \frac{1}{N}\sum_{i=1}^N\frac{f(X_i)}{p(X_i)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(X_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>是采样点在积分域上的概率，即为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mtext>积分域</mtext></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{\text{积分域}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">积分域</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{p(X_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3651em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>相当于矩形的宽</p>
<p>如果在[a,b]上平均采样的特殊情况：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105085409582.png" alt="image-20221105085409582" style="zoom: 50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105085448755.png" alt="image-20221105085448755" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105090535651.png" alt="image-20221105090535651" style="zoom:50%;" />
<p>note：</p>
<ul>
<li>采样点越多，误差就越小</li>
<li>不用关心积分域<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">b-a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>，在考虑积分时不用考虑积分域是多少，积分域已经在PDF(Probility Distribute Function)中体现出来了</li>
<li>Monte Carlo积分要求：在x方向上采样，就在x方向上积分</li>
</ul>
<h3 id="Path-Tracing">Path Tracing</h3>
<h4 id="Problems-of-Witted-Style-Ray-Tracing">Problems of Witted-Style Ray Tracing</h4>
<h5 id="Problem-1">Problem 1</h5>
<p>光线应该被glossy材质（并非完全光滑的材质）反射到哪里</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105091425437.png" alt="image-20221105091425437" style="zoom:50%;" />
<h5 id="Problem-2">Problem 2</h5>
<p>漫反射材质之间的相互反射</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105092241071.png" alt="image-20221105092241071" style="zoom:50%;" />
<h3 id="Whitted-Style-Ray-Tracing-is-Wrong">Whitted-Style Ray Tracing is Wrong</h3>
<p><strong>But Rendering equation is correct</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mi>o</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>L</mi><mi>e</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>e</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mo>∫</mo><mrow><mi mathvariant="normal">Ω</mi><mo>+</mo></mrow></msub><msub><mi>L</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>ω</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">⋅</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>d</mi><msub><mi>ω</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_o(p,\omega_o)=L_e(p,\omega_e)+\int_{\Omega+}L_i(p,\omega_i)f_r(p,\omega_i,\omega_o)(n·\omega_i)d\omega_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3303em;vertical-align:-0.9703em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.4336em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Ω</span><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>但是这个方程包括：</p>
<ul>
<li>计算在半球上的积分</li>
<li>递归计算</li>
</ul>
<h4 id="A-Simple-Monte-Carlo-Solution">A Simple Monte Carlo Solution</h4>
<p>假定渲染一个像素在所受直接光照的结果</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105093211160.png" alt="image-20221105093211160" style="zoom:50%;" />
<p>通过反射方程来做解释（因为渲染方程也只是多了一个自发光），那么实际上就只是一个在不同方向上的积分。通过Monte Carlo积分计算就是随机取一个方向作为随机变量，找到他对应的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>和PDF即可</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105093456799.png" alt="image-20221105093456799" style="zoom:50%;" />
<p>反射点为p</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105093905643.png" alt="image-20221105093905643" style="zoom:50%;" />
<p>将积分变为一个简单的求平均值</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105094308240.png" alt="image-20221105094308240" style="zoom:50%;" />
<p>算法：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105094324469.png" alt="image-20221105094324469" style="zoom:50%;" />
<h5 id="Introducing-Global-Illumination">Introducing Global Illumination</h5>
<p>加入间接光照就相当于：眼睛在P点看Q点，获得P点的吸收能量</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105094541320.png" alt="image-20221105094541320" style="zoom:50%;" />
<p>递归算法：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105094630621.png" alt="image-20221105094630621" style="zoom:50%;" />
<p>但是存在问题</p>
<ul>
<li>
<p>Problem 1：如此计算，光线的数量会“爆炸”</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105094757432.png" alt="image-20221105094757432" style="zoom:50%;" />
<p>N = 1 唯一能防止指数爆炸</p>
<p>所以进一步改进算法：目前，我们假设在每个着色点上只有一根光线被追踪</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105095139458.png" alt="image-20221105095139458" style="zoom:50%;" />
<p>用N = 1来做Monte Carlo积分就叫做<strong>路径追踪</strong>，N != 1叫做分布式光线追踪（光线指数爆炸）</p>
<p>这样获得的结果会变得noisy，不过通过在每个pixel上追踪更多的path（注意不是增加N）并最后取radiance的平均即可</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105095707851.png" alt="image-20221105095707851" style="zoom:50%;" />
<p>算法：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105095803969.png" alt="image-20221105095803969" style="zoom:50%;" />
</li>
<li>
<p>Problem 2：递归算法何时停止？</p>
<p>不能通过限制递归次数的方法来解决，这样做会损失能量，cutting ##bounces == cutting energy，多次弹射的能量就损失了</p>
<p><strong>Solution：Russian Roulette(RR)</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105100649619.png" alt="image-20221105100649619" style="zoom:50%;" />
<p>用俄罗斯轮盘赌的方式来<strong>决定一定的概率停止向下追踪</strong>，即不会一直向下追踪，在一定的条件下会停下来</p>
<p>首先，某一个着色点它的出射的radiance是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">L_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，给一个概率p，，以一定的概率p向某个方向打一条光线，返回值为得到的一定的结果再除以p，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">L_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>/P；在1-p的概率内不打出光线，返回0。最终，<strong>得到的结果的期望仍然为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">L_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105102436818.png" alt="image-20221105102436818" style="zoom:50%;" />
<p>代码：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105103253126.png" alt="image-20221105103253126" style="zoom:50%;" />
</li>
</ul>
<h5 id="Sampling-the-Light">Sampling the Light</h5>
<p>以上已经是正确的Path Tracing了</p>
<p>但是这样的Path Tracing并不高效，SPP不足就会出现很多噪点</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105103628147.png" alt="image-20221105103628147" style="zoom:50%;" />
<p>低效的原因：</p>
<p>在着色点上向半球四面八方均匀采样时，从一个点打出去的很多线中只会有1根打到光源，有很多的光线被浪费</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105103929661.png" alt="image-20221105103929661" style="zoom:50%;" />
<p>Solution：</p>
<p>直接在光源上进行采样<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span>要对光源上的微表面面积进行积分<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span>把BRDF方程改写成对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">dA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span></span></span></span>的积分</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105104542348.png" alt="image-20221105104542348" style="zoom:50%;" />
<p>知到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">dA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>ω</mi></mrow><annotation encoding="application/x-tex">d\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>的关系即可——投影的面积</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105104804357.png" alt="image-20221105104804357" style="zoom:50%;" />
<p>变量替换后：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105105007553.png" alt="image-20221105105007553" style="zoom:50%;" />
<p><strong>所以可以把着色点接收到的</strong>radiance分为两部分：</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105105426685.png" alt="image-20221105105426685" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105105623893.png" alt="image-20221105105623893" style="zoom:50%;" />
<p>多一步判断光源和接收点p之间有物体阻挡</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105105952419.png" alt="image-20221105105952419" style="zoom:50%;" />
<h5 id="Path-Tracing-will-Generate-Photo-Realistic">Path Tracing will Generate Photo-Realistic</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221105110255699.png" alt="image-20221105110255699" style="zoom:50%;" />
<h5 id="Some-Side-Notes">Some Side Notes</h5>
<h6 id="Modern-Concepts-of-Ray-tracing">Modern Concepts of Ray tracing</h6>
<ul>
<li>
<p>Previous</p>
<p>Ray Tracing == Whitted-style ray tracing</p>
</li>
<li>
<p>Modern</p>
<p><strong>The general solution of light transport</strong>, include:</p>
<ul>
<li>Unidirectional &amp; bidirectional path tracing</li>
<li>Photon mapping — 光子映射</li>
<li>Metropolis light transport — 光线传输</li>
<li>VCM — 结合双向路径追踪和光子映射</li>
<li>UPBP — 结合所有方法</li>
</ul>
</li>
</ul>
<h6 id="Haven’t-covered">Haven’t covered</h6>
<ul>
<li>怎样对半球进行采样</li>
<li>Monta Carlo积分能用在任意的pdf上，那么选择什么样的pdf是最好的（importance sampling)</li>
<li>随机数的选取（low discrepancy sequences）</li>
<li>采样半球和采样光源结合（multiple imp. sampling）</li>
<li>对能量的平均是否加权（pixel reconstruction filter）</li>
<li>一个像素里面的radiance怎么混合颜色（gamma correction，curves，color space）</li>
</ul>
<h2 id="材质和外观-Materials-and-Appearances">材质和外观 Materials and Appearances</h2>
<p><strong>Material == BRDF</strong></p>
<h3 id="Diffuse-Lambertian-Material-BRDF">Diffuse/Lambertian Material(BRDF)</h3>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106120044267.png" alt="image-20221106120044267" style="zoom:50%;" />
<p>漫反射系数的正确定义：</p>
<p>假设空间中各个方向进来的irradiance都相同（uniform），反射向各个方向的irradiance也都是uniform，且物体表面不吸收光，由能量守恒得到入射光的radiance和出射光的radiance相同，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>o</mi></msub><mo>=</mo><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_o=L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>r</mi></msub><mo>=</mo><mfrac><mi>ρ</mi><mi>π</mi></mfrac></mrow><annotation encoding="application/x-tex">f_r=\frac{\rho}{\pi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0925em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ρ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106120610555.png" alt="image-20221106120610555" style="zoom:50%;" />
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span>即为albedo：反射率，在0-1之间</p>
<h3 id="Glossy-Material">Glossy Material</h3>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106123526908.png" alt="image-20221106123526908" style="zoom:50%;" />
<h3 id="Ideal-Reflective-Refractive-Material-BSDF">Ideal Reflective/Refractive Material(BSDF)</h3>
<p>BSDF = BRDF + BTDF</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106123806047.png" alt="image-20221106123806047" style="zoom:50%;" />
<h3 id="Perfect-Specular-Reflection">Perfect Specular Reflection</h3>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106124526763.png" alt="image-20221106124526763" style="zoom:50%;" />
<h3 id="Specular-Refraction">Specular Refraction</h3>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106124741807.png" alt="image-20221106124741807" style="zoom:50%;" />
<p><strong>Snell’s Law</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106124957754.png" alt="image-20221106124957754" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106125649137.png" alt="image-20221106125649137" style="zoom:50%;" />
<p><strong>Snell’s Window/Circle</strong></p>
<p>水底只有一个锥形区域会有光线折射进入（只能看到一个锥形区域）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106132831822.png" alt="image-20221106132831822" style="zoom:50%;" />
<h3 id="Fresnel-Reflection-Term">Fresnel Reflection/Term</h3>
<p>现象：不同角度看桌面，反射内容是不一样的</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106133142200.png" alt="image-20221106133142200" style="zoom:50%;" />
<p>菲涅尔项：</p>
<ul>
<li>
<p>绝缘体反射率随入射光角度变化</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106133601427.png" alt="image-20221106133601427" style="zoom:50%;" />
</li>
<li>
<p>导体反射率随入射光角度变化</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106133627846.png" alt="image-20221106133627846" style="zoom:50%;" />
</li>
<li>
<p>计算公式</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106134103673.png" alt="image-20221106134103673" style="zoom:50%;" />
</li>
</ul>
<h3 id="Microfacet-Material">Microfacet Material</h3>
<h4 id="Microfacet-Theory">Microfacet Theory</h4>
<p>粗糙表面：</p>
<ul>
<li>Macroscale：flat&amp;rough（从近处看的是几何）</li>
<li>Microscale：bumpy&amp;specular（从远处看的是材质）</li>
</ul>
<p>单个微表面都想一面镜子一样</p>
<ul>
<li>每个微表面都有自己的法线（朝向）</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106134847542.png" alt="image-20221106134847542" style="zoom:50%;" />
<h4 id="Microfacet-BRDF">Microfacet BRDF</h4>
<ul>
<li>
<p>key：研究微表面发现的分布</p>
<ul>
<li>
<p>微表面分布集中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⟺</mo></mrow><annotation encoding="application/x-tex">\Longleftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mrel">⟺</span></span></span></span>glossy</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106135251122.png" alt="image-20221106135251122" style="zoom:50%;" />
</li>
<li>
<p>微表面分布分散<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⟺</mo></mrow><annotation encoding="application/x-tex">\Longleftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mrel">⟺</span></span></span></span>diffuse</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106135259108.png" alt="image-20221106135259108" style="zoom:50%;" />
</li>
</ul>
</li>
<li>
<p>Microfacet BRDF</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106135721289.png" alt="image-20221106135721289" style="zoom:50%;" />
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>o</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(i,o,h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span> —— shadowing-masking term</p>
<p>微表面之间可能发生相互遮挡，所以有些微表面满足反射但是会被遮挡，失去了他们的作用，即实际计算得到的反射能量可能偏大。Shadowing-masking考虑的就是这个现象。定义一个Grazing Angle，十分接近与法线垂直的角度，当光线接近Grazing Angle时，shadowing-masking就用于修正这个现象。</p>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span> —— distribution of normals</p>
<p>描述有多少微表面实现从入射到出射方向的反射</p>
</li>
</ul>
</li>
</ul>
<h3 id="Isotropic-Anisotropic-Materials">Isotropic/Anisotropic Materials</h3>
<ul>
<li>
<p>Key：directionality of underlying surface</p>
<ul>
<li>
<p>各向同性：认为微表面并不存在一定的方向性或方向性很弱，微表面的发现分布均匀</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106142103414.png" alt="image-20221106142103414" style="zoom:50%;" />
</li>
<li>
<p>各向同性：微表面有一定的方向性</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106142133765.png" alt="image-20221106142133765" style="zoom:50%;" />
</li>
</ul>
</li>
<li>
<p>Anisotropic BRDF</p>
<p>旋转反射的方位角（azimuthal angle），如果观测到的BRDF不变，那么说明是各向同性；如果观察到的BRDF发生变化，那么说明是各向异性（BRDF与绝对方位角有关）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106142426912.png" alt="image-20221106142426912" style="zoom:50%;" />
</li>
</ul>
<h3 id="Properties-of-BRDFs">Properties of BRDFs</h3>
<ul>
<li>
<p>Non-negativit</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>→</mo><msub><mi>ω</mi><mi>r</mi></msub><mo stretchy="false">)</mo><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f_r(\omega_i\rightarrow\omega_r)\ge0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
</li>
<li>
<p>Linearity</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mi>r</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>r</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∫</mo><msup><mi>H</mi><mn>2</mn></msup></msub><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>→</mo><msub><mi>ω</mi><mi>r</mi></msub><mo stretchy="false">)</mo><msub><mi>L</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>ω</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_r(p,\omega_r)=\int_{H^2}f_r(p,\omega_i\rightarrow\omega_r)L_i(p,\omega_i)\cos{\theta_i}d\omega_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2719em;vertical-align:-0.9119em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.3895em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106143600326.png" alt="image-20221106143600326" style="zoom:50%;" />
</li>
<li>
<p>Reciprocity principle</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>r</mi></msub><mo>→</mo><msub><mi>ω</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>→</mo><msub><mi>ω</mi><mi>r</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_r(\omega_r\rightarrow\omega_i)=f_r(\omega_i\rightarrow\omega_r)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106143717293.png" alt="image-20221106143717293" style="zoom:50%;" />
</li>
<li>
<p>Energy conservation</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∀</mi><msub><mi>ω</mi><mi>r</mi></msub><mo>∫</mo><msup><mi>H</mi><mn>2</mn></msup><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>→</mo><msub><mi>ω</mi><mi>r</mi></msub><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mi>i</mi></msub><mi>d</mi><msub><mi>ω</mi><mi>i</mi></msub><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\forall\omega_r\int{H^2}f_r(\omega_i\rightarrow\omega_r)\cos{\theta_i}d\omega_i\le1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2222em;vertical-align:-0.8622em;"></span><span class="mord">∀</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
</li>
<li>
<p>Isotropic vs. anisotropic</p>
<ul>
<li>
<p>If isotropic，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>ϕ</mi><mi>i</mi></msub><mo separator="true">;</mo><msub><mi>θ</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>ϕ</mi><mi>r</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>θ</mi><mi>r</mi></msub><mo separator="true">;</mo><msub><mi>ϕ</mi><mi>r</mi></msub><mo>−</mo><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_r(\theta_i,\phi_i;\theta_r,\phi_r)=f_r(\theta_i,\theta_r;\phi_r-\phi_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，四维降三维</p>
</li>
<li>
<p>Then, from reciprocity,</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>o</mi></msub><mo separator="true">,</mo><msub><mi>θ</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>ϕ</mi><mi>r</mi></msub><mo>−</mo><msub><mi>ϕ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>θ</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>ϕ</mi><mi>i</mi></msub><mo>−</mo><msub><mi>ϕ</mi><mi>r</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>f</mi><mi>r</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>θ</mi><mi>r</mi></msub><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><msub><mi>ϕ</mi><mi>r</mi></msub><mo>−</mo><msub><mi>ϕ</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_r(\theta_o,\theta_r,\phi_r-\phi_i)=f_r(\theta_r,\theta_i,\phi_i-\phi_r)=f_r(\theta_i,\theta_r,|\phi_r-\phi_i|)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span></span></span></span></span></p>
<p>由可逆性得，相对方位角不需要考虑正负，方便BRDF的测量和储存</p>
</li>
</ul>
</li>
</ul>
<h3 id="Measuring-BRDF">Measuring BRDF</h3>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106152910444.png" alt="image-20221106152910444" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106153300191.png" alt="image-20221106153300191" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106153317427.png" alt="image-20221106153317427" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106153334125.png" alt="image-20221106153334125" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106153343318.png" alt="image-20221106153343318" style="zoom:50%;" />
<h2 id="Advanced-Light-Transport">Advanced Light Transport</h2>
<h3 id="Unbiased-light-transport-methods">Unbiased light transport methods</h3>
<h4 id="Biased-vs-Unbiased-Monte-Carlo-Estimators">Biased vs. Unbiased Monte Carlo Estimators</h4>
<ul>
<li>
<p>无偏蒙特卡罗积分不会产生任何逻辑错误</p>
<p>不管用多少采样点，无偏估计的期望值往往是真实值，这样的方法叫做无偏方法</p>
</li>
<li>
<p>有偏：其他情况</p>
<p>特例：期望值在无限多的采样点的情况下收敛于某个值，这样的情况叫做<strong>consistent</strong></p>
</li>
<li>
<p>渲染中的biased和consistent的理解</p>
<ul>
<li>Biased == blurry</li>
<li>Consistent == not blurry with infinite samples</li>
</ul>
</li>
</ul>
<h4 id="Bidirectional-Path-Tracing-BDPT">Bidirectional Path Tracing(BDPT)</h4>
<p>生成从摄像机和光源出发的子路径，再把两个子路径的端点连接起来的方法</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106162543339.png" alt="image-20221106162543339" style="zoom:50%;" />
<ul>
<li>
<p>适用于光线传播在光源处比较复杂的情况</p>
</li>
<li>
<p>但是实现起来会很难，并且很慢</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221106162900262.png" alt="image-20221106162900262" style="zoom:50%;" />
<p>如图，因为Path Tracing从摄像机出发时的第一次bounce是diffuse，导致不好控制它能够打到之后能量集中的地方去，所以效果不好。而Bidirectional Path Tracing可以直接连接光源出发的和摄像机出发的第一次bounce</p>
</li>
</ul>
<h4 id="Metropolis-Light-Transport-MLT">Metropolis Light Transport(MLT)</h4>
<ul>
<li>
<p>A Markov Chain Carlo (MCMC) application</p>
<p>MCMC可以生成以任意函数的形状为PDF的样本，Monte Carlo Estimator中当你采样的PDF和被积函数形状一致时(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>)，得到的variance最小。Markov Chain能够让任何未知的函数生成一系列分布与被积函数形状一致的样本。</p>
</li>
<li>
<p>Very good at locally exploring difficult light paths</p>
</li>
<li>
<p>Key idea :</p>
<ul>
<li>
<p>Locally pertub an existing path to get a new path</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107132716686.png" alt="image-20221107132716686" style="zoom:67%;" />
</li>
</ul>
</li>
<li>
<p>特别适合做复杂的光线传播</p>
<ul>
<li>
<p>只需要找到一条“种子”路径</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107132827046.png" alt="image-20221107132827046" style="zoom:50%;" />
</li>
<li>
<p>caustics：specular-diffuse-specular</p>
</li>
</ul>
</li>
<li>
<p>难以在理论上分析最终的收敛速度（难以估计sample数量和variance的关系）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107133514929.png" alt="image-20221107133514929" style="zoom:50%;" />
</li>
</ul>
<h3 id="Biased-light-transport-methods">Biased light transport methods</h3>
<h4 id="Photon-Mapping">Photon Mapping</h4>
<ul>
<li>
<p>Very Good at hanging Specular—Diffuse—Specular(<strong>SDS</strong>) path and generating <strong>caustics</strong></p>
</li>
<li>
<p>A two-stage method</p>
<ul>
<li>
<p>Stage 1 — photon <strong>tracing</strong></p>
<p><strong>光子</strong>从光源出发，该反射就反射该折射就折射，直到光子遇到一个diffuse材质的物体，光子就停在那里</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107134151274.png" alt="image-20221107134151274" style="zoom:50%;" />
<p>Stage 2 — photon <strong>collection</strong></p>
<p>从视角出发，发射<strong>子路径</strong>，该反射就反射该折射就折射，直到路径打到diffuse材质的物体上</p>
</li>
</ul>
</li>
<li>
<p>Calculation — local density estimation</p>
<ul>
<li>areas with more photons should be brighter</li>
<li>对于每一个shading point，寻找它周围最近的N的光子，划分这几个光子占据着色点周围的面积，用光子数量除以面积获得光子密度</li>
</ul>
</li>
<li>
<p>为什么光子映射phonto mapping是有偏的</p>
<ul>
<li>Local Density esitimation <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>N</mi></mrow><mrow><mi>d</mi><mi>A</mi></mrow></mfrac><mo stretchy="false">!</mo><mo>=</mo><mfrac><mrow><mi mathvariant="normal">Δ</mi><mi>N</mi></mrow><mrow><mi mathvariant="normal">Δ</mi><mi>A</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{dN}{dA} != \frac{\Delta N}{\Delta A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">A</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mathnormal mtight">A</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>当有足够多的光子时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>A</mi><mtext>接近</mtext><mi>d</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">\Delta A\text{接近}dA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">Δ</span><span class="mord mathnormal">A</span><span class="mord text"><span class="mord cjk_fallback">接近</span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span></span></span></span></li>
<li>所以光子映射biased但是<strong>consistent</strong></li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107142647198.png" alt="image-20221107142647198" style="zoom:50%;" />
</li>
</ul>
<h4 id="Vertex-Connection-and-Merging-VCM">Vertex Connection and Merging(VCM)</h4>
<ul>
<li>结合BDPT和Photon Mapping</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107142834200.png" alt="image-20221107142834200" style="zoom: 50%;" />
<h4 id="Instant-Radiosity-IR">Instant Radiosity(IR)</h4>
<ul>
<li>
<p>也叫many-light approaches</p>
</li>
<li>
<p>核心思想：把被照亮的表面看作是新的光源</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107143214922.png" alt="image-20221107143214922" style="zoom:50%;" />
</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107143300208.png" alt="image-20221107143300208" style="zoom:50%;" />
<h2 id="Advanced-Appearance-Modeling">Advanced Appearance Modeling</h2>
<h3 id="Non-surface-models">Non-surface models</h3>
<h4 id="Participating-Media">Participating Media</h4>
<p>Participating Media： <strong>参与介质</strong></p>
<ul>
<li>光线在参与介质中会发生①被吸收②被散射</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107143940544.png" alt="image-20221107143940544" style="zoom:50%;" />
<ul>
<li>
<p>使用Phase Function相位函数来描述光在参与介质中任意位置的散射角度的分布情况</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107144320220.png" alt="image-20221107144320220" style="zoom:50%;" />
</li>
</ul>
<h4 id="Hair-Fur-Fiber-BCSDF">Hair/Fur Fiber (BCSDF)</h4>
<h5 id="Human-Hair">Human Hair</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107145029236.png" alt="image-20221107145029236" style="zoom:50%;" />
<ul>
<li>
<p>Kajiya–Kay Model</p>
<p>只考虑反射和漫反射</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107145137943.png" alt="image-20221107145137943" style="zoom:50%;" />
</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107145235799.png" alt="image-20221107145235799" style="zoom:50%;" />
<ul>
<li>
<p>Marschner Model</p>
<p>光线打到圆柱后</p>
<p>有一部分被直接反射——R</p>
<p>有一部分会穿透后再穿透——TT</p>
<p>有一部分进头发里，在内部反射后再发生第二次穿透——TRT</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107145317967.png" alt="image-20221107145317967" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107145639236.png" alt="image-20221107145639236" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107145700493.png" alt="image-20221107145700493" style="zoom:50%;" />
</li>
</ul>
<h5 id="Fur-Appearance">Fur Appearance</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107150025638.png" alt="image-20221107150025638" style="zoom:50%;" />
<p>动物毛发不能通过人头发的方式进行计算：动物毛发内的髓质比头发的大得多，之前的玻璃柱的模型没有考虑髓质的存在</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107150215739.png" alt="image-20221107150215739" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107150322703.png" alt="image-20221107150322703" style="zoom:50%;" />
<ul>
<li>
<p>Double Cylinder Model——模拟出髓质</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107150345673.png" alt="image-20221107150345673" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107150435496.png" alt="image-20221107150435496" style="zoom:50%;" />
<p><strong>一共五个分量</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107150529063.png" alt="image-20221107150529063" style="zoom:50%;" />
</li>
</ul>
<h4 id="Granular-material">Granular material</h4>
<p><strong>颗粒材质</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107150951579.png" alt="image-20221107150951579" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107151053220.png" alt="image-20221107151053220" style="zoom:50%;" />
<h3 id="Surface-models">Surface models</h3>
<h4 id="Translucent-Materials-BSSRDF">Translucent Materials(BSSRDF)</h4>
<p><strong>Translucent Materials不是实际的半透明，Semitransparent Materials才是半透明</strong></p>
<p>Translucent Material说明的是光线可以从某一个地方进入物体表面，再从另一个地方出物体表面，并非光线传入一个表面并不被吸收，光线可以被导到其它地方去</p>
<ul>
<li>
<p>Jade</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107151710591.png" alt="image-20221107151710591" style="zoom: 33%;" />
</li>
<li>
<p>Jellyfish</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107151727129.png" alt="image-20221107151727129" style="zoom: 33%;" />
</li>
<li>
<p><strong>Subsurface Scattering次表面散射</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107151913664.png" alt="image-20221107151913664" style="zoom:50%;" />
</li>
<li>
<p>Scattering Functions</p>
<ul>
<li>
<p>BSSRDF：对BRDF概念的延申</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107152032544.png" alt="image-20221107152032544" style="zoom:50%;" />
</li>
<li>
<p>Dipole Approximation</p>
<p>当光源照向一个点后，将BSSRDF近似为物体表面内外两个光源共同照亮这一部分的着色点</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107152338492.png" alt="image-20221107152338492" style="zoom:50%;" />
</li>
<li>
<p><strong>BSSRDF的效果：</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107152551271.png" alt="image-20221107152551271" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107152717545.png" alt="image-20221107152717545" style="zoom:50%;" />
</li>
</ul>
</li>
</ul>
<h4 id="Cloth">Cloth</h4>
<h5 id="Rendering-as-Surface">Rendering as Surface</h5>
<p>通过给定的编织模式，计算整体的表现，通过BRDF进行计算</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107153602413.png" alt="image-20221107153602413" style="zoom:50%;" />
<p>不便于处理anisotropic</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107153703945.png" alt="image-20221107153703945" style="zoom: 33%;" />
<h5 id="Rendering-as-Participating-Media">Rendering as Participating Media</h5>
<p>不再把布料当作平面渲染，而是当作体积渲染，可以得到更好的效果，但是渲染的计算量就会大得多</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107153323711.png" alt="image-20221107153323711" style="zoom:50%;" />
<h5 id="Rendering-as-Actual-Fibers">Rendering as Actual Fibers</h5>
<p>精确渲染每一根纤维</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107153420900.png" alt="image-20221107153420900" style="zoom:50%;" />
<h4 id="Detailed-materials-non-statistical-BRDF">Detailed materials(non-statistical BRDF)</h4>
<h5 id="Microfacet-BRDF-2">Microfacet BRDF</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107154915065.png" alt="image-20221107154915065" style="zoom:50%;" />
<p>Normal Distrubution Function(NDF)的不同——实际的NDF存在一些细节，如果能将这些细节考虑进去那么就能得到更好的细节</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107155129655.png" alt="image-20221107155129655" style="zoom:50%;" />
<ul>
<li>
<p>微表面在path tracing上会存在一些问题</p>
<ul>
<li>容易发生path的miss</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107155408515.png" alt="image-20221107155408515" style="zoom:50%;" />
<ul>
<li>
<p>Solution：</p>
<p>考虑一个像素会覆盖很多的微表面，把一个微表面在一个像素对应范围内的法线分布算出来，替代原本光滑的分布并用在微表面模型里</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107155752307.png" alt="image-20221107155752307" style="zoom:50%;" />
<p>不同大小的patch</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107155824853.png" alt="image-20221107155824853" style="zoom:50%;" />
<p>不同的法线贴图</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107155904485.png" alt="image-20221107155904485" style="zoom:50%;" />
</li>
</ul>
</li>
</ul>
<h5 id="Wave-Optics">Wave Optics</h5>
<p>唯一光源下的金属划痕</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107160433755.png" alt="image-20221107160433755" style="zoom:50%;" />
<p><strong>Detailed Material under Wave Optics</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107160359432.png" alt="image-20221107160359432" style="zoom:50%;" />
<h3 id="Procedural-appearance">Procedural appearance</h3>
<ul>
<li>
<p>Define details without textures</p>
<ul>
<li>
<p>Compute a noise fuction on the fly</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107160809718.png" alt="image-20221107160809718" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107160756062.png" alt="image-20221107160756062" style="zoom:50%;" />
</li>
</ul>
</li>
<li>
<p>例如柏林噪波</p>
</li>
</ul>
<h2 id="Camera">Camera</h2>
<p><strong>Imaging = Synthesis + Capture</strong></p>
<h3 id="Inside-a-camera">Inside a camera</h3>
<ul>
<li>
<p>Phinholes &amp; Lenses For Image on Sensor</p>
</li>
<li>
<p>Shutter Exposes Sensor For Precise Duration</p>
</li>
<li>
<p>Sensor Accumulates Irradiance During Exposure</p>
<ul>
<li>
<p>目前传感器只能记录Irradiance，所以需要有针孔或者透镜，来给定记录的方向</p>
</li>
<li>
<p>但是目前有人在研究可以记录radiance的传感器</p>
</li>
</ul>
</li>
</ul>
<h3 id="Pinhole-Image-Formation">Pinhole Image Formation</h3>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107162907241.png" alt="image-20221107162907241" style="zoom:50%;" />
<p>注：针孔相机拍不出深度(景深)，任何地方都是锐利的，拍不到虚化的存在</p>
<p>​		光线追踪利用的是针孔相机的模型，也得不出景深效果</p>
<h3 id="Field-of-View-FOV">Field of View(FOV)</h3>
<p><strong>Effect of Focal Lengh on FOV</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107163405995.png" alt="image-20221107163405995" style="zoom:50%;" />
<p><strong>Effect of Sensor Size of FOV</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221107163839867.png" alt="image-20221107163839867" style="zoom:50%;" />
<h4 id="Exposure">Exposure</h4>
<h5 id="H-T-x-E">H = T x E</h5>
<ul>
<li>
<p>Exposure = time x irradiance</p>
</li>
<li>
<p>Exposure time (T)</p>
<p>Controlled by shutter</p>
</li>
<li>
<p>Irradiance (E)</p>
<p>Power of light falling on a unit area of sensor</p>
<p>Controlled by lens aperture(光圈) and focal lengh</p>
</li>
</ul>
<h5 id="Exposure-Controls-in-Photography">Exposure Controls in Photography</h5>
<ul>
<li>
<p>Aperture size</p>
<p>Change the f-stop(描述光圈大小的量) by opening / closing the aperture</p>
</li>
<li>
<p>Shutter speed</p>
<p>Change the duration the sensor pixels integrate light</p>
</li>
<li>
<p>ISO gain(感光度)</p>
<p>Change the amplification (analog and/or digital) between sensor values and digital values</p>
</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109090334524.png" alt="image-20221109090334524" style="zoom:50%;" />
<h5 id="ISO-Gain">ISO(Gain)</h5>
<p>能够提高曝光度，但是同时会放大噪声</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109090736294.png" alt="image-20221109090736294" style="zoom:50%;" />
<h5 id="F-Number-F-Stop-Exposure-Levels">F-Number(F-Stop) : Exposure Levels</h5>
<p>Written as FN or F/N, N is the f-number</p>
<p>F-Number defined as the <strong>focal lengh divided by the diameter of te aperture</strong></p>
<p>可以认为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mfrac><mn>1</mn><mtext>光圈直径</mtext></mfrac></mrow><annotation encoding="application/x-tex">N=\frac{1}{\text{光圈直径}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">光圈直径</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<h5 id="Physical-Shutter-1-25-Sec-Exposure">Physical Shutter (1/25 Sec Exposure)</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109091445225.png" alt="image-20221109091445225" style="zoom:50%;" />
<ul>
<li>
<p>Side Effect of Shutter Speed</p>
<ul>
<li>
<p>Motion blur ： Handshake, subject movement</p>
</li>
<li>
<p>Boubling shutter times doubles motion blur</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109091601790.png" alt="image-20221109091601790" style="zoom:50%;" />
</li>
<li>
<p>Rolling shutter : different parts of photo taken at different times</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109091802935.png" alt="image-20221109091802935" style="zoom:50%;" />
</li>
<li>
<p>High-Speed Photoraphy</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109092412617.png" alt="image-20221109092412617" style="zoom:50%;" />
</li>
<li>
<p>Long-Exposure Photography(延时摄影)</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109092442779.png" alt="image-20221109092442779" style="zoom:50%;" />
</li>
</ul>
</li>
</ul>
<h4 id="Thin-Lens-Approximation">Thin Lens Approximation</h4>
<p>The Thin Lens Equation</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109092822163.png" alt="image-20221109092822163" style="zoom:50%;" />
<h4 id="Defocus-Blur">Defocus Blur</h4>
<ul>
<li>
<p>Computing Circle of Confusion(CoC) Size</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109094759185.png" alt="image-20221109094759185" style="zoom:50%;" />
<p>一个点的成像反映到sensor上成了一个圈（近视眼）</p>
</li>
<li>
<p>Circle of Confution取决于光圈的大小</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109103311744.png" alt="image-20221109103311744" style="zoom:50%;" />
<p>Size of CoC is Inversely Proportional to F-Stop</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109103714547.png" alt="image-20221109103714547" style="zoom:50%;" />
</li>
</ul>
<h3 id="Ray-Tracing-Ideal-Thin-Lenses">Ray Tracing Ideal Thin Lenses</h3>
<p><strong>原本的Ray Tracing是小孔呈现，但是也可以模拟Lens</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109103931127.png" alt="image-20221109103931127" style="zoom:50%;" />
<h4 id="Ray-Tracing-for-Defocus-Blur-Thin-Lens">Ray Tracing for Defocus Blur (Thin Lens)</h4>
<h5 id="Set-up">Set up:</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109104027409.png" alt="image-20221109104027409" style="zoom:50%;" />
<ul>
<li>Choose sensor size, lens focal lengh, and aperture size</li>
<li>Choose depth of subject of interest <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">z_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>(物距)
<ul>
<li>Calculate corresponding depth of sensor <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> from thin lens equation</li>
</ul>
</li>
</ul>
<h5 id="Rendering">Rendering:</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109104335328.png" alt="image-20221109104335328" style="zoom:50%;" />
<ul>
<li>For each pixel <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> on the sensor</li>
<li>Sample random points <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x&#x27;&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span></span></span></span> on lens plane</li>
<li>You know the ray pssing through the lens will hit <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x&#x27;&#x27;&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′′</span></span></span></span></span></span></span></span></span></span></span></span>(using the thin lens formula, because <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x&#x27;&#x27;&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′′</span></span></span></span></span></span></span></span></span></span></span></span> is in focus, consider virtual ray (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>——center of the l))</li>
<li>Estimate radiance on ray <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo>→</mo><msup><mi>x</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x&#x27;&#x27;\rightarrow x&#x27;&#x27;&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′′</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h4 id="Depth-of-Field">Depth of Field</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109105618952.png" alt="image-20221109105618952" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109105802916.png" alt="image-20221109105802916" style="zoom:50%;" />
<h3 id="Light-Field-Lumigraph">Light Field/Lumigraph</h3>
<h4 id="The-Plenopic-Function">The Plenopic Function</h4>
<p>全光函数：Parameterize everything that he can see</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109112145575.png" alt="image-20221109112145575" style="zoom:50%;" />
<p>is intensity of light</p>
<ul>
<li>Seen from a single view point</li>
<li>At a single time</li>
<li>Average over the wavelenghs(color) of the visible spectrum</li>
</ul>
<p>(can also do <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>, but spherical coordinate are nicer)*</p>
<p>Grayscale snapshot</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109112304734.png" alt="image-20221109112304734" style="zoom:50%;" />
$$
P(\theta,\phi)
$$
<p>Color snapshot</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109112648966.png" alt="image-20221109112648966" style="zoom:50%;" />
$$
P(\theta,\phi,\lambda)
$$
<p>A movie</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109125813979.png" alt="image-20221109125813979" style="zoom:50%;" />
$$
P(\theta,\phi,\lambda,t)
$$
<p>Holographic movie</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109125910489.png" alt="image-20221109125910489" style="zoom:50%;" />
$$
P(\theta,\phi,\lambda,t,V_x,V_y,V_z)
$$
<h5 id="The-Plenoptic-Function">The Plenoptic Function</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109130500712.png" alt="image-20221109130500712" style="zoom:50%;" />
<h4 id="Ray">Ray</h4>
<p>定义光线：</p>
<ul>
<li>
<p>第一类：三维的位置+二维的方向来定义光线</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109131749960.png" alt="image-20221109131749960" style="zoom:50%;" />
</li>
<li>
<p>第二类：二维的位置+二维的方向来定义光线</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109131900868.png" alt="image-20221109131900868" style="zoom:50%;" />
</li>
</ul>
<h4 id="Light-Field">Light Field</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109132140298.png" alt="image-20221109132140298" style="zoom:50%;" />
<p>The surface of a cube holds all the radiance information dut to enclosed object</p>
<p>Light Field：函数记录了物体表面不同位置往各个方向的发光情况，光场即为任何一个位置向任何一个方向的发光强度，光场只是全光函数的一部分，只是位置和方向</p>
<p>2D position：只有s和t轴，位置只是在一个面上进行查询，所以是二维的位置</p>
<p>光场的含义：从任意一个位置看向物体，都能<strong>查询</strong>到各个点的光照信息</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109133315295.png" alt="image-20221109133315295" style="zoom:50%;" />
<p>记录光场：不需要知道光场内部有什么，只需要查询到储存在表面的任何位置任意方向的光照信息即可</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109133607603.png" alt="image-20221109133607603" style="zoom:50%;" />
<p>光场的参数化</p>
<ul>
<li>
<p>1个位置+1个方向进行参数化</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109133839916.png" alt="image-20221109133839916" style="zoom:50%;" />
</li>
<li>
<p>两个平行的平面，各自取点进行参数化</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109133858535.png" alt="image-20221109133858535" style="zoom:50%;" />
</li>
<li>
<p>Lumigraph</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109133923175.png" alt="image-20221109133923175" style="zoom:50%;" />
</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109134832974.png" alt="image-20221109134832974"  />
<p>把一个像素分开并在像素前加一个lens，将来自各个方向的光分到不同的位置，即用一个像素储存了不同方向的irradiance</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109135310056.png" alt="image-20221109135310056" style="zoom:50%;" />
<h4 id="Light-Field-Camera">Light Field Camera</h4>
<p>原理：微透镜(Microlens)，把一个像素替换成一个透镜，使来自不同方向的光通过微透镜分开，分别记录到不同的位置</p>
<p>优势：可以后期动态聚焦——先拍照，再聚焦</p>
<h5 id="Understanding">Understanding</h5>
<p>原本像素储存的irradiance被沿着多个方向拆开了（pixel<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span>block of pixels）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109140335954.png" alt="image-20221109140335954" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109141528173.png" alt="image-20221109141528173" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109142122808.png" alt="image-20221109142122808" style="zoom:50%;" />
<h2 id="Color">Color</h2>
<h3 id="Physical-Basis-of-Color">Physical Basis of Color</h3>
<h4 id="The-Visible-Spectrum-of-Light">The Visible Spectrum of Light</h4>
<p>Electromagnetic radiance</p>
<ul>
<li>
<p>Oscillations of different frequencies (wavelenghs)</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109145116422.png" alt="image-20221109145116422" style="zoom:50%;" />
</li>
</ul>
<h4 id="Spectrual-Power-Distribution-SPD">Spectrual Power Distribution (SPD)</h4>
<p>Salient property in measuring light</p>
<p>即光线不同的波长对应的强度</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109145531636.png" alt="image-20221109145531636" style="zoom:50%;" />
<p><strong>SPD of light sources</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109145636052.png" alt="image-20221109145636052" style="zoom:50%;" />
<p><strong>Linearity of SPD</strong>：线性关系，<strong>可加性</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109145703756.png" alt="image-20221109145703756" style="zoom:50%;" />
<h3 id="Biological-Basis-of-Color">Biological Basis of Color</h3>
<h4 id="Anatomy-of-the-Human-Eye">Anatomy of the Human Eye</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109150128747.png" alt="image-20221109150128747" style="zoom:50%;" />
<h4 id="Retinal-Photoreceptor-Cells：Rods-and-Cones">Retinal Photoreceptor Cells：Rods and Cones</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109150522267.png" alt="image-20221109150522267" style="zoom:50%;" />
<ul>
<li>
<p>Rod cells：很多，但是只能感知光的强度，得到灰度图</p>
</li>
<li>
<p>Cone cells：相对较少，能感知光的颜色，又分为三类</p>
<ul>
<li>锥形细胞分类及响应曲线图：</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109150504086.png" alt="image-20221109150504086" style="zoom: 50%;" />
<ul>
<li>
<p>锥形细胞在不同人身上分布的差异很大</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109150722600.png" alt="image-20221109150722600" style="zoom:50%;" />
</li>
</ul>
</li>
</ul>
<h3 id="Tristimulus-Theory-of-Color">Tristimulus Theory of Color</h3>
<h4 id="Spectral-Response-of-Human-Cone-Cells">Spectral Response of Human Cone Cells</h4>
<p>感知：光线波长SPD和感知细胞响应曲线相乘的积分，得到的<strong>SML才是感知到的颜色</strong>，而不是光的SPD</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109150955582.png" alt="image-20221109150955582" style="zoom:50%;" />
<h4 id="The-Human-Visual-System">The Human Visual System</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109151240772.png" alt="image-20221109151240772" style="zoom:50%;" />
<h4 id="Metamerism">Metamerism</h4>
<p><strong>同色异谱现象</strong>：不同的SPD但是看到同样的颜色的现象</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109151537946.png" alt="image-20221109151537946" style="zoom:50%;" />
<p><strong>Color matching</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109151629313.png" alt="image-20221109151629313" style="zoom:50%;" />
<h3 id="Color-Reproduction-Matching">Color Reproduction/Matching</h3>
<h4 id="Additive-Color">Additive Color</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109151755784.png" alt="image-20221109151755784" style="zoom:50%;" />
<h4 id="Color-Reproduction-with-Matching-Functions">Color Reproduction with Matching Functions</h4>
<p>s——SPD</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109152345475.png" alt="image-20221109152345475" style="zoom:50%;" />
<h3 id="Color-Spaces">Color Spaces</h3>
<h4 id="Standard-Color-Spaces">Standard Color Spaces</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109152657664.png" alt="image-20221109152657664" style="zoom:67%;" />
<h4 id="A-Universal-Color-Space-CIE-XYZ">A Universal Color Space: CIE XYZ</h4>
<p>另一套匹配系统：一套人造的颜色匹配系统，初值不是存在的颜色</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109152920001.png" alt="image-20221109152920001" style="zoom: 67%;" />
<h4 id="Separating-Luminance，Chromaticity">Separating Luminance，Chromaticity</h4>
<p><strong>让XYZ系统能表示的颜色显示出来</strong></p>
<p>对大写的XYZ做一个可视化：将XYZ进行归一化（此处的归一和向量不同，此处只是指x+y+z=1），固定了Y，可视化x，y（因为Y只是强度）</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109153909093.png" alt="image-20221109153909093" style="zoom:50%;" />
<h4 id="CIE-Chromaticity-Diagram">CIE Chromaticity Diagram</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109154012297.png" alt="image-20221109154012297" style="zoom:50%;" />
<h4 id="Gamut">Gamut</h4>
<p>不同的颜色空间Gamut色域是不同的</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109154421884.png" alt="image-20221109154421884" style="zoom:50%;" />
<h4 id="HSV-Color-Space">HSV Color Space</h4>
<p><strong>Hue—Saturation—Value</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109154748402.png" alt="image-20221109154748402" style="zoom:67%;" />
<h4 id="CIELAB-Space-AKA-L-a-b">CIELAB Space(AKA L*a*b*)</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109154924702.png" alt="image-20221109154924702" style="zoom:50%;" />
<h5 id="Opponent-Color-Theory"><strong>Opponent Color Theory</strong></h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109155127206.png" alt="image-20221109155127206" style="zoom: 67%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109155137787.png" alt="image-20221109155137787" style="zoom:67%;" />
<h3 id="CMYK-A-Subtractive-Color-Space">CMYK: A Subtractive Color Space</h3>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221109155913938.png" alt="image-20221109155913938" style="zoom:50%;" />
<h2 id="Animation-Intro">Animation Intro</h2>
<h3 id="Keyframe-Animation">Keyframe Animation</h3>
<h4 id="Keyframe">Keyframe</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110083228747.png" alt="image-20221110083228747" style="zoom: 80%;" />
<ul>
<li>Lead animator creates keyframes</li>
<li>Assistant (person or computer) creates in-between frames (“tweening”)</li>
</ul>
<h4 id="Keyframe-Interpolation">Keyframe Interpolation</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110083455365.png" alt="image-20221110083455365" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110083543341.png" alt="image-20221110083543341" style="zoom:50%;" />
<h3 id="Physical-Simulation">Physical Simulation</h3>
<ul>
<li>Newton’s Law</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo>=</mo><mi>m</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">F = ma
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ma</span></span></span></span></span></p>
<ul>
<li>
<p>Generate motion of objects using numerical simulation</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110083811115.png" alt="image-20221110083811115" style="zoom:50%;" />
</li>
<li>
<p>Example</p>
<ul>
<li>Cloth Simulation</li>
<li>Fluids
<ul>
<li>模拟流体如何运动</li>
<li>模拟位置、形状后去渲染，得出模样</li>
</ul>
</li>
<li>Mass Spring Rope/Mesh（质点弹簧系统）</li>
<li>Hair</li>
</ul>
</li>
</ul>
<h3 id="Mass-Spring-System">Mass Spring System</h3>
<h4 id="A-Simple-Spring">A Simple Spring</h4>
<p>—— 一系列相互连接的<strong>质点</strong>和<strong>弹簧</strong></p>
<h5 id="Idealized-spring">Idealized spring</h5>
<p>Zero length spring</p>
<ul>
<li>
<p>Hooke‘s Law</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>a</mi><mo>→</mo><mi>b</mi></mrow></msub><mo>=</mo><msub><mi>k</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_{a\rightarrow b} = k_s(b-a)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">→</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>a</mi><mo>→</mo><mi>b</mi></mrow></msub><mo>=</mo><mo>−</mo><msub><mi>f</mi><mrow><mi>b</mi><mo>→</mo><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{a\rightarrow b} = -f_{b\rightarrow a}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">→</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mrel mtight">→</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>Problem: this spring wants to have zero length</p>
</li>
</ul>
<h5 id="Non-Zero-Length-Spring">Non-Zero Length Spring</h5>
<p>Spring with non-zero <strong>rest length<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(l)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>a</mi><mo>→</mo><mi>b</mi></mrow></msub><mo>=</mo><msub><mi>k</mi><mi>s</mi></msub><mfrac><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>b</mi><mo>−</mo><mi>a</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>b</mi><mo>−</mo><mi>a</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_{a\rightarrow b}=k_s\frac{b-a}{||b-a||}(||b-a||-l)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">→</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">a</span><span class="mord">∣∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">∣∣</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord">∣∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></span></p>
<p>Problem: oscillates forever</p>
<h5 id="Dot-Notation-for-Derivatives">Dot Notation for Derivatives</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110085300203.png" alt="image-20221110085300203" style="zoom:50%;" />
<h5 id="Internal-Damping-Force-Energy-Loss">Internal Damping Force(Energy Loss)</h5>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110090041930.png" alt="image-20221110090041930" style="zoom:50%;" />
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">k_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a damping coefficient</p>
</li>
<li>
<p>Viscous drag only on change in spring length</p>
</li>
</ul>
<h4 id="Structures-from-Springs">Structures from Springs</h4>
<ul>
<li>
<p>Behavior is determined by structure linkages</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110090901637.png" alt="image-20221110090901637" style="zoom:50%;" />
<ul>
<li>This Structure will not resist shearing</li>
<li>This structure will not resist out-of-plane bending (该形状可以折成一个平面并且没有反抗弯曲的力)</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110091404952.png" alt="image-20221110091404952" style="zoom:50%;" />
<ul>
<li>This structure will resist shearing. Less directional bias.</li>
<li>This structure will resist out-of-plane bending. Red spring should be much weaker（蓝色线力更强，红色只是用来抵抗弯曲）</li>
</ul>
</li>
</ul>
<h4 id="Aside-FEM">Aside: FEM</h4>
<p><strong>Finite Element Method(FEM)</strong> Instead of Springs</p>
<p>有限元方法，适用于力的扩散与传导</p>
<h3 id="Particle-Systems">Particle Systems</h3>
<h4 id="Particle-system">Particle system</h4>
<ul>
<li>
<p>Model dynamical systems as collection of large numbers of particles</p>
</li>
<li>
<p>Each particle’s motion is defined by a set of physical (or non-physical) forces (e.g. 粒子之间的碰撞、引力，粒子受到的重力)</p>
</li>
<li>
<p>Popular technique in graphics and games</p>
<ul>
<li>Easy to understand , implement</li>
<li>Scalable: fewer particles for speed, more higher complexity</li>
</ul>
</li>
<li>
<p>Challenges</p>
<ul>
<li>May need many particles (e.g. fluid)</li>
<li>May need acceleration structure (e.g. to find nearest particles for interactions)</li>
</ul>
</li>
</ul>
<h4 id="Particle-System-Animations">Particle System Animations</h4>
<p>For each frame in animation</p>
<ul>
<li>[If needed] Create new particles</li>
<li>Calculate forces on each particle</li>
<li>Update each particle’s position and velocity</li>
<li>[If needed] Remove dead particles</li>
<li>Render particles</li>
</ul>
<h4 id="Particles-System-Forces">Particles System Forces</h4>
<ul>
<li>
<p>Attraction and repulsion forces</p>
<ul>
<li>Gravity, electromagnetism, …</li>
<li>Springs, propulsion, …</li>
</ul>
</li>
<li>
<p>Damping forces</p>
<ul>
<li>Friction, air drag, viscosity, …</li>
</ul>
</li>
<li>
<p>Collisions</p>
<ul>
<li>Walls, containers, fixed objects, …</li>
<li>Dynamic objects, character body parts, …</li>
</ul>
</li>
<li>
<p>Gravitational Attraction</p>
<ul>
<li>
<p>Newton’s universal law of gravitation</p>
<ul>
<li>Gravitational pull between particles<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>g</mi></msub><mo>=</mo><mi>G</mi><mfrac><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub></mrow><msup><mi>d</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">F_g = G\frac{m_1m_2}{d^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Examples</p>
<ul>
<li>
<p>Galaxy Simulation</p>
</li>
<li>
<p>Particle-Based Fluids</p>
</li>
</ul>
</li>
</ul>
<h4 id="Simulated-Flocking-as-an-ODE">Simulated Flocking as an ODE</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110094637224.png" alt="image-20221110094637224" style="zoom:50%;" />
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110094716284.png" alt="image-20221110094716284" style="zoom:50%;" />
<p><strong>考虑个体与群体之间的联系</strong></p>
<h3 id="Forward-Kinematics">Forward Kinematics</h3>
<h4 id="Forward-Kinematics-2">Forward Kinematics</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110154614676.png" alt="image-20221110154614676" style="zoom: 25%;" />
<p>Articulated skeleton</p>
<ul>
<li>Topology (what’s connected to what)</li>
<li>Geometric relations from joints</li>
<li>Tree structure (in absence of loops)</li>
</ul>
<p>Joint types</p>
<ul>
<li>
<p>Pin (1D rotation)</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110154753466.png" alt="image-20221110154753466" style="zoom:50%;" />
</li>
<li>
<p>Ball (2D rotation)</p>
</li>
<li>
<p>Prismatic joint (translation)</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110154703490.png" alt="image-20221110154703490" style="zoom:50%;" />
</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110154641331.png" alt="image-20221110154641331" style="zoom:50%;" />
<p>Kinematics Pros and Cons</p>
<p>Strenghs</p>
<ul>
<li>Direct control is convenient</li>
<li>Implementation is straightforward</li>
</ul>
<p>Weakness</p>
<ul>
<li>Animation may be inconsistent with physics</li>
<li>Time consuming for artists</li>
</ul>
<h4 id="Inverse-Kinematics">Inverse Kinematics</h4>
<p>Animator provides position of end-effector, and computer must determine joint angles that satisfy constrains</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110221119909.png" alt="image-20221110221119909" style="zoom:50%;" />
<p>Problems(Hard):</p>
<ul>
<li>
<p>Multiple solutions in configuration space</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110221323011.png" alt="image-20221110221323011" style="zoom:50%;" />
</li>
<li>
<p>Solutions may not always exist</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110221410474.png" alt="image-20221110221410474" style="zoom:50%;" />
</li>
</ul>
<p>Numerical solution to general N-link IK problem</p>
<ul>
<li>Choose an initial configuration</li>
<li>Define an error metric</li>
<li>Compute gradient of error as function of configuration</li>
<li>Apply gradient descent</li>
</ul>
<h3 id="Rigging">Rigging</h3>
<p>Rigging is a set of higher level controls on a character that allow more rapid &amp; intuitive modification of pose, deformations, expression, etc.</p>
<p>Important</p>
<ul>
<li>Like strings on a puppet</li>
<li>Captures all meaningful character changes</li>
<li>Varies from character to character</li>
</ul>
<p>Expensive to create</p>
<ul>
<li>Manual effort</li>
<li>Requires both artistic and technical training</li>
</ul>
<p><strong>Blend Shapes</strong></p>
<p>Instead of skeleton, interpolate directly between surfaces</p>
<p>Simplest scheme: take linear combination of vertex positions</p>
<p>Spline used to control choice of weight over time</p>
<p>(控制点和控制点之间做插值，blend控制点及控制点周围能够影响的区域)</p>
<h3 id="Motion-Capture">Motion Capture</h3>
<p>Data-driven approach to creating animation sequences</p>
<ul>
<li>Record real-world performance</li>
<li>Extract pose as a function of time from the data collected</li>
</ul>
<p><strong>Pros and Cons</strong></p>
<ul>
<li>Strenghs
<ul>
<li>Can acpture arge amounts of real data quickly</li>
<li>Realism can be high</li>
</ul>
</li>
<li>Weaknesses
<ul>
<li>Complex and costly set-ups</li>
<li>Captured animation may not meet artistic needs, requiring alterations</li>
</ul>
</li>
</ul>
<h3 id="The-Production-Pipeline">The Production Pipeline</h3>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221110225001723.png" alt="image-20221110225001723" style="zoom: 80%;" />
<h2 id="Animation-Simulation">Animation Simulation</h2>
<h3 id="Single-Particle-Simulation">Single Particle Simulation</h3>
<p>First: study motion of a single particle</p>
<p>Later: generalize to a multitude of particles</p>
<h4 id="Velocity-Field">Velocity Field</h4>
<p>To start, assume motion of particle determined by a velocity vector field that is a function of position and time: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v(x,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111104313402.png" alt="image-20221111104313402" style="zoom:50%;" />
<h4 id="Ordinary-Differential-Equation-ODE">Ordinary Differential Equation(ODE)</h4>
<p>Computing position of particle over time requires solving a first-order ordinary differential equation:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>v</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{dx}{dt} = x&#x27; = v(x,t)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span></p>
<ul>
<li>“first-order”: the first derivative being taken</li>
<li>“Ordinary”: no partial derivative (i.e. x is just a function of t)</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111110640553.png" alt="image-20221111110640553" style="zoom:50%;" />
<h4 id="Euler’s-Method">Euler’s Method</h4>
<ul>
<li>
<p>Simple iterative method</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></msup><mo>=</mo><msup><mi>x</mi><mi>t</mi></msup><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mi>t</mi></msup><msup><mo stretchy="false">)</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x^{t+\Delta t} = x^t + \Delta t(x^t)&#x27;
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">Δ</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9269em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0936em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></msub><msup><mo stretchy="false">)</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mi>t</mi></msup><msup><mo stretchy="false">)</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mi>t</mi></msup><msup><mo stretchy="false">)</mo><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">(x_{t+\Delta t})&#x27; = (x^t)&#x27; + \Delta t(x^t)&#x27;&#x27;
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">Δ</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0936em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0936em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>Euler’s Method - Errors</p>
<p>With numerical integration, errors accumulate</p>
<p>增大time step可以减小误差</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111125044191.png" alt="image-20221111125044191" style="zoom:50%;" />
<p>time step affect the accuracy</p>
</li>
<li>
<p>Instability of Euler Method</p>
<p>不稳定，例如要沿着下面的圆形移动，但不管time step有多小，往下进行会越来越脱离想要的结果</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111125339723.png" alt="image-20221111125339723" style="zoom:50%;" />
</li>
</ul>
<h4 id="Errors-and-Instability">Errors and Instability</h4>
<p>Solving by numerical integration with finite differences leads to two problems:</p>
<ul>
<li>
<p>Errors</p>
<ul>
<li>
<p>Errors at each time step accumulate</p>
<p>Accuracy decreases as simulation proceeds</p>
</li>
<li>
<p>Accuracy may not be critical in graphics applications</p>
</li>
</ul>
</li>
<li>
<p>Instability</p>
<ul>
<li>Errors can compound, causing the simulation to <strong>diverge</strong> even when the underlying system does not</li>
<li>Lack ok stability is a fundamental problem in simulation, and cannot be ignored</li>
</ul>
</li>
</ul>
<h4 id="Combating-Instability">Combating Instability</h4>
<p><strong>How to determine/quantize “stability”?</strong></p>
<ul>
<li>
<p>Local truncation error(every step) / total accumulated error(overall)</p>
</li>
<li>
<p>这些数字没有意义，研究的是他们的导数</p>
</li>
<li>
<p>Implicit Euler has order 1, which means that</p>
<ul>
<li>
<p>Local truncation error: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>h</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(h^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
</li>
<li>
<p>Global truncation error: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span></p>
<p>(h is the step, i.e. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span>)</p>
</li>
</ul>
</li>
<li>
<p>Understanding of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span></p>
<p>If we halve h, we can expect the error to halve as well</p>
</li>
</ul>
<h5 id="Midpoint-Method-Modified-Euler">Midpoint Method/Modified Euler</h5>
<ul>
<li>Average velocities at start and endpoint</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111131159438.png" alt="image-20221111131159438" style="zoom:50%;" />
<p>理想运动路径是中间的曲线，实际路径是下面的直线</p>
<p>实际上是用了两次Euler方法，先用出发点的速度场来算出中点b的速度，在以此速度回到起始点作为真正的速度</p>
<ul>
<li>
<p>Better results: 算出的局部的二次模型，优于原本的一次模型</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111131540742.png" alt="image-20221111131540742" style="zoom:50%;" />
</li>
</ul>
<h5 id="Adaptive-Step-Size">Adaptive Step Size</h5>
<p>试着把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span>分成两个部分，如果两个结果相差很远，就减小step size并再次进行判断</p>
<p>得到右下的图，在不同的位置会有不同的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111132259048.png" alt="image-20221111132259048" style="zoom:50%;" />
<h5 id="Implicit-Backward-Euler-Method">Implicit(Backward) Euler Method</h5>
<ul>
<li>
<p>Use derivatives in the future, for the current step</p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111143114062.png" alt="image-20221111143114062" style="zoom:67%;" />
</li>
<li>
<p>Solve nonlinear problem for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">x^{t+\Delta t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">Δ</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></msup><msup><mo stretchy="false">)</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">(x^{t+\Delta t})&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">Δ</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>Using root-finding algorithm</p>
</li>
<li>
<p>Offers much better stability</p>
</li>
</ul>
<h5 id="Rung-Kutta-Families">Rung-Kutta Families</h5>
<p>A family of advanced methods for solving ODEs</p>
<ul>
<li>Especially good at dealing with non0linearity</li>
<li>It’s order-four version is the most widely used</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111192642402.png" alt="image-20221111192642402" style="zoom:50%;" />
<h5 id="Position-Based-Verlet-Integration">Position-Based/Verlet Integration</h5>
<ul>
<li>
<p>Idea:</p>
<ul>
<li>After modified Euler forward-step, constrain position of particles to prevent divergent, unstable behavior</li>
<li>Use constrained positions to calculate velocity</li>
<li>Both of these ideas will dissipate energy, stabilize</li>
</ul>
</li>
<li>
<p>Pros and cons</p>
<ul>
<li>Fast and simple</li>
<li>Not physically based, dissipates energy(error)</li>
</ul>
</li>
</ul>
<h3 id="Rigid-Body-Simulation">Rigid Body Simulation</h3>
<p>物体内的所有点运动规律都一致</p>
<p>Simple case</p>
<ul>
<li>Similar to simulation a particle</li>
<li>Just consider a bit more properties</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111193458458.png" alt="image-20221111193458458" style="zoom:50%;" />
<h3 id="Fluid-Simulation">Fluid Simulation</h3>
<h4 id="A-Simple-Position-Based-Method">A Simple Position-Based Method</h4>
<p>Key idea</p>
<ul>
<li>Assuming water is composed of small rigid-body spheres</li>
<li>Assuming the water cannot be compressed(i.e. const density)</li>
<li>So, as long as the density changes somewhere, it should be “corrected” via changing the position of particles</li>
<li>You need to know the gradient of the density anywhere w.r.t. each particle’s position</li>
<li>任何一个位置上让原本不正确的密度恢复原本的密度，并且我知道如何调整各个小球的位置使得他的密度往我们所需的方向上去变化——Gradient Descent</li>
</ul>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111194137333.png" alt="image-20221111194137333" style="zoom:80%;" />
<h4 id="Eulerian-vs-Lagrangian">Eulerian vs. Lagrangian</h4>
<p>Two different views to simulating <strong>large collections of matters</strong></p>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111195004578.png" alt="image-20221111195004578" style="zoom:50%;" />
<h4 id="Material-Point-Method-MPM">Material Point Method(MPM)</h4>
<img src="http://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/image-20221111195259997.png" alt="image-20221111195259997" style="zoom:50%;" />
<h3 id="—Next—">—Next—</h3>
<ul>
<li>Games201 —— Advanced Physics Engines 2020: A Hands-on Tutorial</li>
<li>Real-Time High Quality Rendering</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://himoqiuhan.github.io">楸涵</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://himoqiuhan.github.io/2022/10/09/Notes-Games101-2/">https://himoqiuhan.github.io/2022/10/09/Notes-Games101-2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://himoqiuhan.github.io" target="_blank">楸涵の小窝</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/">图形学</a><a class="post-meta__tags" href="/tags/GAMES/">GAMES</a></div><div class="post_share"><div class="social-share" data-image="/images/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/10/09/Notes-Games101-1/" title="Games101课程笔记（一）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Games101课程笔记（一）</div></div></a></div><div class="next-post pull-right"><a href="/2023/02/01/Projects-Blender-LearningRecord1/" title="【Blender】Blender建模入门学习总结"><img class="cover" src="https://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/BlenderNewIcon.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【Blender】Blender建模入门学习总结</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/10/09/Notes-Games101-1/" title="Games101课程笔记（一）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-09</div><div class="title">Games101课程笔记（一）</div></div></a></div><div><a href="/2023/04/29/Projects-CPPSoftRasterizerRenderer/" title="【C++】软光栅渲染器"><img class="cover" src="https://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/SoftRenderer_Cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-29</div><div class="title">【C++】软光栅渲染器</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">楸涵</div><div class="author-info__description">嘿！一起突破次元壁吗！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">53</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" href="/about/"><i class="fas fa-meteor"></i><span>About Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/himoqiuhan" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.zhihu.com/people/qiu-han-71-64/posts" target="_blank" title="Zhihu"><i class="fab fa-zhihu" style="color: #24292e;"></i></a><a class="social-icon" href="https://space.bilibili.com/374860285" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #24292e;"></i></a><a class="social-icon" href="https://steamcommunity.com/profiles/76561198866659933" target="_blank" title="Steam"><i class="fab fa-steam" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><p>欢迎来和我聊天！</p> <p>QQ：1419091648</p> <p>微信：Himo_qiuhan</p></div></div><div class="card-widget card_portfolio"><div class="item-headline"><i></i><span>作品集</span></div><div class="item-content"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%89%E7%BA%BF%E8%BF%BD%E8%B8%AA-Ray-Tracing"><span class="toc-number">1.</span> <span class="toc-text">光线追踪 Ray Tracing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-Ray-Tracing"><span class="toc-number">1.1.</span> <span class="toc-text">Why Ray Tracing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Ray-Tracing-Algorithm"><span class="toc-number">1.2.</span> <span class="toc-text">Basic Ray-Tracing Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Light-Rays"><span class="toc-number">1.2.1.</span> <span class="toc-text">Light Rays</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ray-Casting"><span class="toc-number">1.2.2.</span> <span class="toc-text">Ray Casting</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Recursive-Whitted-Style-Ray-Tracing"><span class="toc-number">1.2.3.</span> <span class="toc-text">Recursive(Whitted-Style) Ray Tracing</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ray-Surface-Intersection"><span class="toc-number">1.3.</span> <span class="toc-text">Ray-Surface Intersection</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Ray-Equation"><span class="toc-number">1.3.1.</span> <span class="toc-text">Ray Equation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Plane-Equation"><span class="toc-number">1.3.2.</span> <span class="toc-text">Plane Equation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Moller-Trumbore-Algorithm"><span class="toc-number">1.3.3.</span> <span class="toc-text">Moller Trumbore Algorithm</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Accelerating-Ray-Surface-Intersection"><span class="toc-number">1.4.</span> <span class="toc-text">Accelerating Ray-Surface Intersection</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Bounding-Volumes%EF%BC%88BVol%EF%BC%89"><span class="toc-number">1.4.1.</span> <span class="toc-text">Bounding Volumes（BVol）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ray-Intersection-with-Box"><span class="toc-number">1.4.2.</span> <span class="toc-text">Ray-Intersection with Box</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ray-Intersection-with-Axis-Aligned-Box"><span class="toc-number">1.4.3.</span> <span class="toc-text">Ray Intersection with Axis-Aligned Box</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Using-AABBs-to-accelerate-ray-tracing"><span class="toc-number">1.4.4.</span> <span class="toc-text">Using AABBs to accelerate ray tracing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Uniform-Spatial-Partition-Grids"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">Uniform Spatial Partition(Grids)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Preprocess-%E2%80%94-Build-Acceleration-Grid"><span class="toc-number">1.4.4.1.1.</span> <span class="toc-text">Preprocess — Build Acceleration Grid</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Ray-Scene-Intersection"><span class="toc-number">1.4.4.1.2.</span> <span class="toc-text">Ray-Scene Intersection</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Grid-Resolution"><span class="toc-number">1.4.4.1.3.</span> <span class="toc-text">Grid Resolution</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#When-Uniform-Grids-Fail"><span class="toc-number">1.4.4.1.4.</span> <span class="toc-text">When Uniform Grids Fail</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Spatial-Partitions"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">Spatial Partitions</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Spatial-Partitioning-Examples"><span class="toc-number">1.4.4.2.1.</span> <span class="toc-text">Spatial Partitioning Examples</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#KD-Tree-Pre-Processing"><span class="toc-number">1.4.4.2.2.</span> <span class="toc-text">KD-Tree Pre-Processing</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Data-Structure-for-KD-Trees"><span class="toc-number">1.4.4.2.3.</span> <span class="toc-text">Data Structure for KD-Trees</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Traversing-a-KD-Tree"><span class="toc-number">1.4.4.2.4.</span> <span class="toc-text">Traversing a KD-Tree</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Problem"><span class="toc-number">1.4.4.2.5.</span> <span class="toc-text">Problem</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Object-Partition-Bounding-Volume-Hierarchy-BVH"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">Object Partition &amp; Bounding Volume Hierarchy(BVH)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Data-Structure-for-BVHs"><span class="toc-number">1.4.4.3.1.</span> <span class="toc-text">Data Structure for BVHs</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#BVH-Traveral"><span class="toc-number">1.4.4.3.2.</span> <span class="toc-text">BVH Traveral</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Spatial-vs-Object-Partitions"><span class="toc-number">1.4.4.3.3.</span> <span class="toc-text">Spatial vs Object Partitions</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Basic-Radiometry"><span class="toc-number">1.4.5.</span> <span class="toc-text">Basic Radiometry</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#why-radiomentry"><span class="toc-number">1.4.5.0.1.</span> <span class="toc-text">why radiomentry</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Radiometry"><span class="toc-number">1.4.5.0.2.</span> <span class="toc-text">Radiometry</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Radiant-Energy-and-Flux-Power"><span class="toc-number">1.4.5.0.3.</span> <span class="toc-text">Radiant Energy and Flux(Power)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Radiant-intensity"><span class="toc-number">1.4.5.0.4.</span> <span class="toc-text">Radiant intensity</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Irradiance"><span class="toc-number">1.4.5.0.5.</span> <span class="toc-text">Irradiance</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Radiance"><span class="toc-number">1.4.5.0.6.</span> <span class="toc-text">Radiance</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BRDF-and-Rendering-Equation"><span class="toc-number">1.4.6.</span> <span class="toc-text">BRDF and Rendering Equation</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#BRDF"><span class="toc-number">1.4.6.0.1.</span> <span class="toc-text">BRDF</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Reflection-Equation"><span class="toc-number">1.4.6.0.2.</span> <span class="toc-text">Reflection Equation</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Rendering-Equation"><span class="toc-number">1.4.6.0.3.</span> <span class="toc-text">Rendering Equation</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Summary"><span class="toc-number">1.4.6.0.4.</span> <span class="toc-text">Summary</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E8%BF%BD%E8%B8%AA-Path-Tracing"><span class="toc-number">2.</span> <span class="toc-text">路径追踪 Path Tracing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Monte-Carlo-Integration"><span class="toc-number">2.1.</span> <span class="toc-text">Monte Carlo Integration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#What-How"><span class="toc-number">2.1.1.</span> <span class="toc-text">What&amp;How</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Definition"><span class="toc-number">2.1.2.</span> <span class="toc-text">Definition</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Path-Tracing"><span class="toc-number">2.2.</span> <span class="toc-text">Path Tracing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Problems-of-Witted-Style-Ray-Tracing"><span class="toc-number">2.2.1.</span> <span class="toc-text">Problems of Witted-Style Ray Tracing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Problem-1"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">Problem 1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Problem-2"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">Problem 2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Whitted-Style-Ray-Tracing-is-Wrong"><span class="toc-number">2.3.</span> <span class="toc-text">Whitted-Style Ray Tracing is Wrong</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-Simple-Monte-Carlo-Solution"><span class="toc-number">2.3.1.</span> <span class="toc-text">A Simple Monte Carlo Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Introducing-Global-Illumination"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">Introducing Global Illumination</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Sampling-the-Light"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">Sampling the Light</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Path-Tracing-will-Generate-Photo-Realistic"><span class="toc-number">2.3.1.3.</span> <span class="toc-text">Path Tracing will Generate Photo-Realistic</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Some-Side-Notes"><span class="toc-number">2.3.1.4.</span> <span class="toc-text">Some Side Notes</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Modern-Concepts-of-Ray-tracing"><span class="toc-number">2.3.1.4.1.</span> <span class="toc-text">Modern Concepts of Ray tracing</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Haven%E2%80%99t-covered"><span class="toc-number">2.3.1.4.2.</span> <span class="toc-text">Haven’t covered</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%90%E8%B4%A8%E5%92%8C%E5%A4%96%E8%A7%82-Materials-and-Appearances"><span class="toc-number">3.</span> <span class="toc-text">材质和外观 Materials and Appearances</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Diffuse-Lambertian-Material-BRDF"><span class="toc-number">3.1.</span> <span class="toc-text">Diffuse&#x2F;Lambertian Material(BRDF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Glossy-Material"><span class="toc-number">3.2.</span> <span class="toc-text">Glossy Material</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ideal-Reflective-Refractive-Material-BSDF"><span class="toc-number">3.3.</span> <span class="toc-text">Ideal Reflective&#x2F;Refractive Material(BSDF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Perfect-Specular-Reflection"><span class="toc-number">3.4.</span> <span class="toc-text">Perfect Specular Reflection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Specular-Refraction"><span class="toc-number">3.5.</span> <span class="toc-text">Specular Refraction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fresnel-Reflection-Term"><span class="toc-number">3.6.</span> <span class="toc-text">Fresnel Reflection&#x2F;Term</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Microfacet-Material"><span class="toc-number">3.7.</span> <span class="toc-text">Microfacet Material</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Microfacet-Theory"><span class="toc-number">3.7.1.</span> <span class="toc-text">Microfacet Theory</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Microfacet-BRDF"><span class="toc-number">3.7.2.</span> <span class="toc-text">Microfacet BRDF</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Isotropic-Anisotropic-Materials"><span class="toc-number">3.8.</span> <span class="toc-text">Isotropic&#x2F;Anisotropic Materials</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Properties-of-BRDFs"><span class="toc-number">3.9.</span> <span class="toc-text">Properties of BRDFs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Measuring-BRDF"><span class="toc-number">3.10.</span> <span class="toc-text">Measuring BRDF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Advanced-Light-Transport"><span class="toc-number">4.</span> <span class="toc-text">Advanced Light Transport</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Unbiased-light-transport-methods"><span class="toc-number">4.1.</span> <span class="toc-text">Unbiased light transport methods</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Biased-vs-Unbiased-Monte-Carlo-Estimators"><span class="toc-number">4.1.1.</span> <span class="toc-text">Biased vs. Unbiased Monte Carlo Estimators</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bidirectional-Path-Tracing-BDPT"><span class="toc-number">4.1.2.</span> <span class="toc-text">Bidirectional Path Tracing(BDPT)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Metropolis-Light-Transport-MLT"><span class="toc-number">4.1.3.</span> <span class="toc-text">Metropolis Light Transport(MLT)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Biased-light-transport-methods"><span class="toc-number">4.2.</span> <span class="toc-text">Biased light transport methods</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Photon-Mapping"><span class="toc-number">4.2.1.</span> <span class="toc-text">Photon Mapping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Vertex-Connection-and-Merging-VCM"><span class="toc-number">4.2.2.</span> <span class="toc-text">Vertex Connection and Merging(VCM)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Instant-Radiosity-IR"><span class="toc-number">4.2.3.</span> <span class="toc-text">Instant Radiosity(IR)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Advanced-Appearance-Modeling"><span class="toc-number">5.</span> <span class="toc-text">Advanced Appearance Modeling</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Non-surface-models"><span class="toc-number">5.1.</span> <span class="toc-text">Non-surface models</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Participating-Media"><span class="toc-number">5.1.1.</span> <span class="toc-text">Participating Media</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hair-Fur-Fiber-BCSDF"><span class="toc-number">5.1.2.</span> <span class="toc-text">Hair&#x2F;Fur Fiber (BCSDF)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Human-Hair"><span class="toc-number">5.1.2.1.</span> <span class="toc-text">Human Hair</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Fur-Appearance"><span class="toc-number">5.1.2.2.</span> <span class="toc-text">Fur Appearance</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Granular-material"><span class="toc-number">5.1.3.</span> <span class="toc-text">Granular material</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Surface-models"><span class="toc-number">5.2.</span> <span class="toc-text">Surface models</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Translucent-Materials-BSSRDF"><span class="toc-number">5.2.1.</span> <span class="toc-text">Translucent Materials(BSSRDF)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cloth"><span class="toc-number">5.2.2.</span> <span class="toc-text">Cloth</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Rendering-as-Surface"><span class="toc-number">5.2.2.1.</span> <span class="toc-text">Rendering as Surface</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Rendering-as-Participating-Media"><span class="toc-number">5.2.2.2.</span> <span class="toc-text">Rendering as Participating Media</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Rendering-as-Actual-Fibers"><span class="toc-number">5.2.2.3.</span> <span class="toc-text">Rendering as Actual Fibers</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Detailed-materials-non-statistical-BRDF"><span class="toc-number">5.2.3.</span> <span class="toc-text">Detailed materials(non-statistical BRDF)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Microfacet-BRDF-2"><span class="toc-number">5.2.3.1.</span> <span class="toc-text">Microfacet BRDF</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Wave-Optics"><span class="toc-number">5.2.3.2.</span> <span class="toc-text">Wave Optics</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Procedural-appearance"><span class="toc-number">5.3.</span> <span class="toc-text">Procedural appearance</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Camera"><span class="toc-number">6.</span> <span class="toc-text">Camera</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Inside-a-camera"><span class="toc-number">6.1.</span> <span class="toc-text">Inside a camera</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pinhole-Image-Formation"><span class="toc-number">6.2.</span> <span class="toc-text">Pinhole Image Formation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Field-of-View-FOV"><span class="toc-number">6.3.</span> <span class="toc-text">Field of View(FOV)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Exposure"><span class="toc-number">6.3.1.</span> <span class="toc-text">Exposure</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#H-T-x-E"><span class="toc-number">6.3.1.1.</span> <span class="toc-text">H &#x3D; T x E</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Exposure-Controls-in-Photography"><span class="toc-number">6.3.1.2.</span> <span class="toc-text">Exposure Controls in Photography</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ISO-Gain"><span class="toc-number">6.3.1.3.</span> <span class="toc-text">ISO(Gain)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#F-Number-F-Stop-Exposure-Levels"><span class="toc-number">6.3.1.4.</span> <span class="toc-text">F-Number(F-Stop) : Exposure Levels</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Physical-Shutter-1-25-Sec-Exposure"><span class="toc-number">6.3.1.5.</span> <span class="toc-text">Physical Shutter (1&#x2F;25 Sec Exposure)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thin-Lens-Approximation"><span class="toc-number">6.3.2.</span> <span class="toc-text">Thin Lens Approximation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Defocus-Blur"><span class="toc-number">6.3.3.</span> <span class="toc-text">Defocus Blur</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ray-Tracing-Ideal-Thin-Lenses"><span class="toc-number">6.4.</span> <span class="toc-text">Ray Tracing Ideal Thin Lenses</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Ray-Tracing-for-Defocus-Blur-Thin-Lens"><span class="toc-number">6.4.1.</span> <span class="toc-text">Ray Tracing for Defocus Blur (Thin Lens)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Set-up"><span class="toc-number">6.4.1.1.</span> <span class="toc-text">Set up:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Rendering"><span class="toc-number">6.4.1.2.</span> <span class="toc-text">Rendering:</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Depth-of-Field"><span class="toc-number">6.4.2.</span> <span class="toc-text">Depth of Field</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Light-Field-Lumigraph"><span class="toc-number">6.5.</span> <span class="toc-text">Light Field&#x2F;Lumigraph</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#The-Plenopic-Function"><span class="toc-number">6.5.1.</span> <span class="toc-text">The Plenopic Function</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#The-Plenoptic-Function"><span class="toc-number">6.5.1.1.</span> <span class="toc-text">The Plenoptic Function</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ray"><span class="toc-number">6.5.2.</span> <span class="toc-text">Ray</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Light-Field"><span class="toc-number">6.5.3.</span> <span class="toc-text">Light Field</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Light-Field-Camera"><span class="toc-number">6.5.4.</span> <span class="toc-text">Light Field Camera</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Understanding"><span class="toc-number">6.5.4.1.</span> <span class="toc-text">Understanding</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Color"><span class="toc-number">7.</span> <span class="toc-text">Color</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Physical-Basis-of-Color"><span class="toc-number">7.1.</span> <span class="toc-text">Physical Basis of Color</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#The-Visible-Spectrum-of-Light"><span class="toc-number">7.1.1.</span> <span class="toc-text">The Visible Spectrum of Light</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spectrual-Power-Distribution-SPD"><span class="toc-number">7.1.2.</span> <span class="toc-text">Spectrual Power Distribution (SPD)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Biological-Basis-of-Color"><span class="toc-number">7.2.</span> <span class="toc-text">Biological Basis of Color</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Anatomy-of-the-Human-Eye"><span class="toc-number">7.2.1.</span> <span class="toc-text">Anatomy of the Human Eye</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Retinal-Photoreceptor-Cells%EF%BC%9ARods-and-Cones"><span class="toc-number">7.2.2.</span> <span class="toc-text">Retinal Photoreceptor Cells：Rods and Cones</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tristimulus-Theory-of-Color"><span class="toc-number">7.3.</span> <span class="toc-text">Tristimulus Theory of Color</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Spectral-Response-of-Human-Cone-Cells"><span class="toc-number">7.3.1.</span> <span class="toc-text">Spectral Response of Human Cone Cells</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#The-Human-Visual-System"><span class="toc-number">7.3.2.</span> <span class="toc-text">The Human Visual System</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Metamerism"><span class="toc-number">7.3.3.</span> <span class="toc-text">Metamerism</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Color-Reproduction-Matching"><span class="toc-number">7.4.</span> <span class="toc-text">Color Reproduction&#x2F;Matching</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Additive-Color"><span class="toc-number">7.4.1.</span> <span class="toc-text">Additive Color</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Color-Reproduction-with-Matching-Functions"><span class="toc-number">7.4.2.</span> <span class="toc-text">Color Reproduction with Matching Functions</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Color-Spaces"><span class="toc-number">7.5.</span> <span class="toc-text">Color Spaces</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Standard-Color-Spaces"><span class="toc-number">7.5.1.</span> <span class="toc-text">Standard Color Spaces</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#A-Universal-Color-Space-CIE-XYZ"><span class="toc-number">7.5.2.</span> <span class="toc-text">A Universal Color Space: CIE XYZ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Separating-Luminance%EF%BC%8CChromaticity"><span class="toc-number">7.5.3.</span> <span class="toc-text">Separating Luminance，Chromaticity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CIE-Chromaticity-Diagram"><span class="toc-number">7.5.4.</span> <span class="toc-text">CIE Chromaticity Diagram</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Gamut"><span class="toc-number">7.5.5.</span> <span class="toc-text">Gamut</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HSV-Color-Space"><span class="toc-number">7.5.6.</span> <span class="toc-text">HSV Color Space</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CIELAB-Space-AKA-L-a-b"><span class="toc-number">7.5.7.</span> <span class="toc-text">CIELAB Space(AKA L*a*b*)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Opponent-Color-Theory"><span class="toc-number">7.5.7.1.</span> <span class="toc-text">Opponent Color Theory</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMYK-A-Subtractive-Color-Space"><span class="toc-number">7.6.</span> <span class="toc-text">CMYK: A Subtractive Color Space</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Animation-Intro"><span class="toc-number">8.</span> <span class="toc-text">Animation Intro</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Keyframe-Animation"><span class="toc-number">8.1.</span> <span class="toc-text">Keyframe Animation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Keyframe"><span class="toc-number">8.1.1.</span> <span class="toc-text">Keyframe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Keyframe-Interpolation"><span class="toc-number">8.1.2.</span> <span class="toc-text">Keyframe Interpolation</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Physical-Simulation"><span class="toc-number">8.2.</span> <span class="toc-text">Physical Simulation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mass-Spring-System"><span class="toc-number">8.3.</span> <span class="toc-text">Mass Spring System</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-Simple-Spring"><span class="toc-number">8.3.1.</span> <span class="toc-text">A Simple Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Idealized-spring"><span class="toc-number">8.3.1.1.</span> <span class="toc-text">Idealized spring</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Non-Zero-Length-Spring"><span class="toc-number">8.3.1.2.</span> <span class="toc-text">Non-Zero Length Spring</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Dot-Notation-for-Derivatives"><span class="toc-number">8.3.1.3.</span> <span class="toc-text">Dot Notation for Derivatives</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Internal-Damping-Force-Energy-Loss"><span class="toc-number">8.3.1.4.</span> <span class="toc-text">Internal Damping Force(Energy Loss)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Structures-from-Springs"><span class="toc-number">8.3.2.</span> <span class="toc-text">Structures from Springs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Aside-FEM"><span class="toc-number">8.3.3.</span> <span class="toc-text">Aside: FEM</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Particle-Systems"><span class="toc-number">8.4.</span> <span class="toc-text">Particle Systems</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Particle-system"><span class="toc-number">8.4.1.</span> <span class="toc-text">Particle system</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Particle-System-Animations"><span class="toc-number">8.4.2.</span> <span class="toc-text">Particle System Animations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Particles-System-Forces"><span class="toc-number">8.4.3.</span> <span class="toc-text">Particles System Forces</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Simulated-Flocking-as-an-ODE"><span class="toc-number">8.4.4.</span> <span class="toc-text">Simulated Flocking as an ODE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forward-Kinematics"><span class="toc-number">8.5.</span> <span class="toc-text">Forward Kinematics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Forward-Kinematics-2"><span class="toc-number">8.5.1.</span> <span class="toc-text">Forward Kinematics</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Inverse-Kinematics"><span class="toc-number">8.5.2.</span> <span class="toc-text">Inverse Kinematics</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rigging"><span class="toc-number">8.6.</span> <span class="toc-text">Rigging</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Motion-Capture"><span class="toc-number">8.7.</span> <span class="toc-text">Motion Capture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Production-Pipeline"><span class="toc-number">8.8.</span> <span class="toc-text">The Production Pipeline</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Animation-Simulation"><span class="toc-number">9.</span> <span class="toc-text">Animation Simulation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Single-Particle-Simulation"><span class="toc-number">9.1.</span> <span class="toc-text">Single Particle Simulation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Velocity-Field"><span class="toc-number">9.1.1.</span> <span class="toc-text">Velocity Field</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ordinary-Differential-Equation-ODE"><span class="toc-number">9.1.2.</span> <span class="toc-text">Ordinary Differential Equation(ODE)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Euler%E2%80%99s-Method"><span class="toc-number">9.1.3.</span> <span class="toc-text">Euler’s Method</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Errors-and-Instability"><span class="toc-number">9.1.4.</span> <span class="toc-text">Errors and Instability</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Combating-Instability"><span class="toc-number">9.1.5.</span> <span class="toc-text">Combating Instability</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Midpoint-Method-Modified-Euler"><span class="toc-number">9.1.5.1.</span> <span class="toc-text">Midpoint Method&#x2F;Modified Euler</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Adaptive-Step-Size"><span class="toc-number">9.1.5.2.</span> <span class="toc-text">Adaptive Step Size</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Implicit-Backward-Euler-Method"><span class="toc-number">9.1.5.3.</span> <span class="toc-text">Implicit(Backward) Euler Method</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Rung-Kutta-Families"><span class="toc-number">9.1.5.4.</span> <span class="toc-text">Rung-Kutta Families</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Position-Based-Verlet-Integration"><span class="toc-number">9.1.5.5.</span> <span class="toc-text">Position-Based&#x2F;Verlet Integration</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rigid-Body-Simulation"><span class="toc-number">9.2.</span> <span class="toc-text">Rigid Body Simulation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fluid-Simulation"><span class="toc-number">9.3.</span> <span class="toc-text">Fluid Simulation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-Simple-Position-Based-Method"><span class="toc-number">9.3.1.</span> <span class="toc-text">A Simple Position-Based Method</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Eulerian-vs-Lagrangian"><span class="toc-number">9.3.2.</span> <span class="toc-text">Eulerian vs. Lagrangian</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Material-Point-Method-MPM"><span class="toc-number">9.3.3.</span> <span class="toc-text">Material Point Method(MPM)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%94Next%E2%80%94"><span class="toc-number">9.4.</span> <span class="toc-text">—Next—</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/07/04/Projects-Game-Unity-QuanLiuShi-V2/" title="【Unity】二次元3D动作角色扮演游戏《泉流石》- V2"><img src="https://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/20250705232053.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【Unity】二次元3D动作角色扮演游戏《泉流石》- V2"/></a><div class="content"><a class="title" href="/2025/07/04/Projects-Game-Unity-QuanLiuShi-V2/" title="【Unity】二次元3D动作角色扮演游戏《泉流石》- V2">【Unity】二次元3D动作角色扮演游戏《泉流石》- V2</a><time datetime="2025-07-04T15:03:29.000Z" title="发表于 2025-07-04 23:03:29">2025-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/31/Projects-Game-Unity-QuanLiuShi/" title="【Unity】二次元3D动作角色扮演游戏《泉流石》"><img src="https://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/CH03_17.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【Unity】二次元3D动作角色扮演游戏《泉流石》"/></a><div class="content"><a class="title" href="/2024/08/31/Projects-Game-Unity-QuanLiuShi/" title="【Unity】二次元3D动作角色扮演游戏《泉流石》">【Unity】二次元3D动作角色扮演游戏《泉流石》</a><time datetime="2024-08-31T07:37:03.000Z" title="发表于 2024-08-31 15:37:03">2024-08-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/30/Projects-Game-Unity-WitchsNight/" title="【Unity】颜色组合塔防游戏《女巫缤纷夜》"><img src="https://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/20240801012107.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【Unity】颜色组合塔防游戏《女巫缤纷夜》"/></a><div class="content"><a class="title" href="/2024/07/30/Projects-Game-Unity-WitchsNight/" title="【Unity】颜色组合塔防游戏《女巫缤纷夜》">【Unity】颜色组合塔防游戏《女巫缤纷夜》</a><time datetime="2024-07-30T07:37:03.000Z" title="发表于 2024-07-30 15:37:03">2024-07-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/28/Notes-TA100-A4510/" title="技术美术百人计划学习笔记（美术4.5 特效规范及拆分实现）"><img src="https://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/TA100.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="技术美术百人计划学习笔记（美术4.5 特效规范及拆分实现）"/></a><div class="content"><a class="title" href="/2024/07/28/Notes-TA100-A4510/" title="技术美术百人计划学习笔记（美术4.5 特效规范及拆分实现）">技术美术百人计划学习笔记（美术4.5 特效规范及拆分实现）</a><time datetime="2024-07-28T09:20:57.000Z" title="发表于 2024-07-28 17:20:57">2024-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/13/Anima-SoundEuphonium/" title="《響け！ユーフォニアム》杂谈"><img src="https://qiuhanblog-imgsubmit.oss-cn-beijing.aliyuncs.com/img/SoundEuphonium-cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="《響け！ユーフォニアム》杂谈"/></a><div class="content"><a class="title" href="/2024/02/13/Anima-SoundEuphonium/" title="《響け！ユーフォニアム》杂谈">《響け！ユーフォニアム》杂谈</a><time datetime="2024-02-13T06:14:39.000Z" title="发表于 2024-02-13 14:14:39">2024-02-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By 楸涵</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">欢迎来到楸涵的小窝！</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  let initFn = window.walineFn || null

  const initWaline = (Fn) => {
    const waline = Fn(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://blog-comment-68npiieuq-himoqiuhan.vercel.app/',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, null))

    const destroyWaline = () => {
      waline.destroy()
    }

    btf.addGlobalFn('pjax', destroyWaline, 'destroyWaline')
  }

  const loadWaline = async () => {
    if (initFn) initWaline(initFn)
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css')
      const { init } = await import('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js')
      initFn = init || Waline.init
      initWaline(initFn)
      window.walineFn = initFn
    }
  }

  if ('Waline' === 'Waline' || !true) {
    if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>